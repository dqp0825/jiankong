!function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=630)}({11:function(t,e,n){"use strict";t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var i={},o=0;o<this.length;o++){var r=this[o][0];"number"==typeof r&&(i[r]=!0)}for(o=0;o<e.length;o++){var a=e[o];"number"==typeof a[0]&&i[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},112:function(t,e,n){"use strict";(function(t){var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};/**
 *
 *   IntersectionParams.js
 *
 *   copyright 2002, Kevin Lindsey
 *
 *   contribution {@link http://github.com/Quazistax/kld-polynomial}
 *       @copyright 2015 Robert Benko (Quazistax) <quazistax@gmail.com>
 *       @license MIT
 */
!function(i,o){if("object"===e(t)&&"object"===e(t.exports)){var r=n(18);t.exports=o(r.Point2D,r.Vector2D)}else i.IntersectionParams=o()}(void 0,function(t,e){function n(t,e){this.init(t,e)}n.prototype.init=function(t,e){this.type=t,this.params=e,this.meta={}},n.TYPE={};var i=n.TYPE;!function(){var t=Object.defineProperty;t(i,"LINE",{value:"Line"}),t(i,"RECT",{value:"Rectangle"}),t(i,"ROUNDRECT",{value:"RoundRectangle"}),t(i,"CIRCLE",{value:"Circle"}),t(i,"ELLIPSE",{value:"Ellipse"}),t(i,"POLYGON",{value:"Polygon"}),t(i,"POLYLINE",{value:"Polyline"}),t(i,"PATH",{value:"Path"}),t(i,"ARC",{value:"Arc"}),t(i,"BEZIER2",{value:"Bezier2"}),t(i,"BEZIER3",{value:"Bezier3"})}(),n.newArc=function(t,e,o,r,a,s,l){var h=n.Utils.getArcParamaters(t,e,o,r,a,s,l);return new n(i.ARC,[h.center,h.rx,h.ry,a*Math.PI/180,h.theta1,h.deltaTheta])},n.newBezier2=function(t,e,o){return new n(i.BEZIER2,[t,e,o])},n.newBezier3=function(t,e,o,r){return new n(i.BEZIER3,[t,e,o,r])},n.newCircle=function(t,e){return new n(i.CIRCLE,[t,e])},n.newEllipse=function(t,e,o){return new n(i.ELLIPSE,[t,e,o])},n.newLine=function(t,e){return new n(i.LINE,[t,e])},n.newPolygon=function(t){return new n(i.POLYGON,[t])},n.newPolyline=function(t){return new n(i.POLYLINE,[t])},n.newPath=function(t){return new n(i.PATH,[t])},n.newRect=function(e,o,r,a){var s=[];return s.push(new t(e,o)),s.push(new t(e+r,o)),s.push(new t(e+r,o+a)),s.push(new t(e,o+a)),new n(i.RECT,[s])};var o=function(t){return t*Math.PI/180};return n.newRoundRect=function(e,r,a,s,l,h){if(0===l&&0===h)return n.newRect(e,r,a,s);0===l&&(l=h),0===h&&(h=l),l>a/2&&(l=a/2),h>s/2&&(l=s/2);var c=[],y=e,u=e+l,p=e+a-l,d=e+a,f=r,x=r+h,v=r+s-h,g=r+s;return c.push(new n(i.ARC,[new t(u,x),l,h,0,o(180),o(90)])),c.push(new n(i.LINE,[new t(u,f),new t(p,f)])),c.push(new n(i.ARC,[new t(p,x),l,h,0,o(-90),o(90)])),c.push(new n(i.LINE,[new t(d,x),new t(d,v)])),c.push(new n(i.ARC,[new t(p,v),l,h,0,o(0),o(90)])),c.push(new n(i.LINE,[new t(p,g),new t(u,g)])),c.push(new n(i.ARC,[new t(u,v),l,h,0,o(90),o(90)])),c.push(new n(i.LINE,[new t(y,v),new t(y,x)])),c[c.length-1].meta.closePath=!0,new n(i.ROUNDRECT,[c])},n.Utils={},n.Utils.getArcParamaters=function(n,i,o,r,a,s,l){function h(t,e,n,i){var o=t*n+e*i,r=Math.sqrt((t*t+e*e)*(n*n+i*i)),a=Math.acos(o/r);return t*i-e*n<0&&(a=-a),a}a=a*Math.PI/180;var c,y=Math.cos(a),u=Math.sin(a),p=n.subtract(i).divide(2),d=p.x*y+p.y*u,f=p.x*-u+p.y*y,x=d*d,v=f*f,g=x/(o*o)+v/(r*r);g>1&&(c=Math.sqrt(g),o*=c,r*=c);var m=o*o,b=r*r,w=m*v,k=b*x;c=(m*b-w-k)/(w+k),Math.abs(c)<1e-6&&(c=0);var _=Math.sqrt(c);s==l&&(_=-_);for(var E=n.add(i).divide(2),M=_*o*f/r,P=_*-r*d/o,T=(d-M)/o,I=(d+M)/o,A=(f-P)/r,N=(f+P)/r,R=(new e(1,0),h(1,0,T,A)),C=h(T,A,-I,-N),S=2*Math.PI;C>S;)C-=S;for(;C<0;)C+=S;return 0==l&&(C-=S),{center:new t(M*y-P*u+E.x,M*u+P*y+E.y),rx:o,ry:r,theta1:R,deltaTheta:C}},n})}).call(e,n(65)(t))},113:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=n(27),l=function(t){return t&&t.__esModule?t:{default:t}}(s),h=n(20),c=n(18),y=function(t){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=r.radius,s=void 0===a?20:a;i(this,e);var l=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,{width:s,height:s}));return l.shapeName="Circle",l.radius=s,l.setBoundingRect(),l.setIntersectionShape(),l}return r(e,t),a(e,[{key:"setBoundingRect",value:function(){var t=this.radius;this.top=this.left=-t,this.right=this.bottom=t}},{key:"renderTo",value:function(t){this.elem=t,this.renderCapacity();var e=this.radius;t.append("g").attr("class","node-icon").append("circle").attr("class","shape shape-circle").attr("cx",0).attr("cy",0).attr("r",e),this.renderText()}},{key:"getIntersectionShape",value:function(t){if(this.topo.options.capacityVisibility)return this.getMaxIntersectionShape(t);var e=this.radius;return t&&(e+=t),h.IntersectionParams.newCircle(new c.Point2D(0,0),e)}}]),e}(l.default);e.default=y},114:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){o=!0,r=t}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),h=n(5),c=i(h),y=n(27),u=i(y),p=n(41),d=i(p),f=n(20),x=n(18),v=function(t){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.width,s=void 0===a?43:a,l=i.points,h=void 0===l?5:l,y=i.radius,u=void 0===y?8:y;o(this,e);var p=d.default.compute(s,h),f=p.height,x=p.length,v=p.angle,g=p.positions,m=p.top,b=p.right,w=p.bottom,k=p.left,_=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,{width:s,height:f}));_.shapeName="RoundPolygon",_.points=h,_.radius=u,_.length=x,_.angle=v,_.positions=g,_._top=m,_._right=b,_._bottom=w,_._left=k,_.setBoundingRect();var E=_.handles=[],M=Math.PI/2+v/2,P=_.cut=u/Math.tan(v/2);return _.gap=u/Math.sin(v/2),c.default.forEach(g,function(t){var e=Math.cos(M)*P+t[0],n=Math.sin(M)*P+t[1],i=M-v,o=Math.cos(i)*P+t[0],r=Math.sin(i)*P+t[1];E.push([e,n]),E.push([o,r]),M=i+Math.PI}),_.setIntersectionShape(),_}return a(e,t),l(e,[{key:"setBoundingRect",value:function(){var t=this._top,e=this._right,n=this._bottom,i=this._left;this.top=t,this.right=e,this.bottom=n,this.left=i}},{key:"renderTo",value:function(t){this.elem=t,this.renderCapacity();var e=this.radius,n=[];c.default.forEach(this.handles,function(t,i){var o=t[0],r=t[1];0===i?n.push("M"+o+" "+r):i%2?n.push("A"+e+" "+e+" 0 0 1 "+o+" "+r):n.push("L"+o+" "+r)}),t.append("g").attr("class","node-icon").append("path").attr("class","shape shape-round-polygon").attr("d",n.join("")),this.renderText()}},{key:"getIntersectionShape",value:function(t){if(this.topo.options.capacityVisibility)return this.getMaxIntersectionShape(t);var e=f.IntersectionParams.TYPE,n=this.positions,i=this.handles,o=this.angle,r=this.top,a=this.length,l=this.radius,h=this.cut,y=this.gap,u=[];if(t){var p=Math.cos(o/2),d=Math.sin(o/2),v=l+t,g=v,m=p*v*2,b=-p*t-d*h,w=r-d*t+p*h,k=Math.PI+o/2,_=Math.PI-o;c.default.forEach(n,function(t){var n=s(t,2),i=n[0],r=n[1],l=k+_+o/2,c=b+Math.cos(l)*m,p=w+Math.sin(l)*m,d=k+_+Math.PI/2,E=c+Math.cos(d)*(a-2*h),M=p+Math.sin(d)*(a-2*h),P=l+Math.PI/2;i+=Math.cos(P)*y,r+=Math.sin(P)*y,u.push(new f.IntersectionParams(e.ARC,[new x.Point2D(i,r),v,g,0,k,_])),u.push(new f.IntersectionParams(e.LINE,[new x.Point2D(c,p),new x.Point2D(E,M)])),b=E,w=M,k+=_})}else{var E=void 0,M=void 0;c.default.forEach(i,function(t,e){var n=t[0],i=t[1];e%2?u.push(f.IntersectionParams.newArc(new x.Point2D(E,M),new x.Point2D(n,i),l,l,0,0,1)):0!==e&&u.push(f.IntersectionParams.newLine(new x.Point2D(E,M),new x.Point2D(n,i))),E=n,M=i})}return f.IntersectionParams.newPath(u)}}]),e}(u.default);e.default=v},166:function(t,e,n){"use strict";function o(){this.init(arguments)}/**
 *
 *   Polynomial.js
 *
 *   copyright 2002, 2013 Kevin Lindsey
 * 
 *   contribution {@link http://github.com/Quazistax/kld-polynomial}
 *       @copyright 2015 Robert Benko (Quazistax) <quazistax@gmail.com>
 *       @license MIT
 */
o.TOLERANCE=1e-6,o.ACCURACY=15,o.interpolate=function(t,e,n,i,o){if(t.constructor!==Array||e.constructor!==Array)throw new Error("Polynomial.interpolate: xs and ys must be arrays");if(isNaN(n)||isNaN(i)||isNaN(o))throw new Error("Polynomial.interpolate: n, offset, and x must be numbers");for(var r=0,a=0,s=new Array(n),l=new Array(n),h=0,c=Math.abs(o-t[i]),y=0;y<n;y++){var u=Math.abs(o-t[i+y]);u<c&&(h=y,c=u),s[y]=l[y]=e[i+y]}r=e[i+h],h--;for(var p=1;p<n;p++){for(var y=0;y<n-p;y++){var d=t[i+y]-o,f=t[i+y+p]-o,x=s[y+1]-l[y],v=d-f;if(0==v){({y:0,dy:0});break}v=x/v,l[y]=f*v,s[y]=d*v}a=2*(h+1)<n-p?s[h+1]:l[h--],r+=a}return{y:r,dy:a}},o.prototype.init=function(t){this.coefs=new Array;for(var e=t.length-1;e>=0;e--)this.coefs.push(t[e]);this._variable="t",this._s=0},o.prototype.eval=function(t){if(isNaN(t))throw new Error("Polynomial.eval: parameter must be a number");for(var e=0,n=this.coefs.length-1;n>=0;n--)e=e*t+this.coefs[n];return e},o.prototype.add=function(t){for(var e=new o,n=this.getDegree(),i=t.getDegree(),r=Math.max(n,i),a=0;a<=r;a++){var s=a<=n?this.coefs[a]:0,l=a<=i?t.coefs[a]:0;e.coefs[a]=s+l}return e},o.prototype.multiply=function(t){for(var e=new o,n=0;n<=this.getDegree()+t.getDegree();n++)e.coefs.push(0);for(var n=0;n<=this.getDegree();n++)for(var i=0;i<=t.getDegree();i++)e.coefs[n+i]+=this.coefs[n]*t.coefs[i];return e},o.prototype.divide_scalar=function(t){for(var e=0;e<this.coefs.length;e++)this.coefs[e]/=t},o.prototype.simplify=function(){for(var t=this.getDegree();t>=0&&Math.abs(this.coefs[t])<=1e-15;t--)this.coefs.pop()},o.prototype.bisection=function(t,e){var n,i=this.eval(t),r=this.eval(e);if(Math.abs(i)<=o.TOLERANCE)n=t;else if(Math.abs(r)<=o.TOLERANCE)n=e;else if(i*r<=0)for(var a=Math.log(e-t),s=Math.LN10*o.ACCURACY,l=Math.ceil((a+s)/Math.LN2),h=0;h<l;h++){n=.5*(t+e);var c=this.eval(n);if(Math.abs(c)<=o.TOLERANCE)break;c*i<0?(e=n,r=c):(t=n,i=c)}return n},o.prototype.toString=function(){for(var t=new Array,e=new Array,n=this.coefs.length-1;n>=0;n--){var i=Math.round(1e3*this.coefs[n])/1e3;if(0!=i){var o=i<0?" - ":" + ";i=Math.abs(i),n>0&&(1==i?i=this._variable:i+=this._variable),n>1&&(i+="^"+n),e.push(o),t.push(i)}}e[0]=" + "==e[0]?"":"-";for(var r="",n=0;n<t.length;n++)r+=e[n]+t[n];return r},o.prototype.trapezoid=function(t,e,n){if(isNaN(t)||isNaN(e)||isNaN(n))throw new Error("Polynomial.trapezoid: parameters must be numbers");var i=e-t;if(1==n){var o=this.eval(t),r=this.eval(e);this._s=.5*i*(o+r)}else{for(var a=1<<n-2,s=i/a,l=t+.5*s,h=0,c=0;c<a;c++)h+=this.eval(l),l+=s;this._s=.5*(this._s+i*h/a)}if(isNaN(this._s))throw new Error("Polynomial.trapezoid: this._s is NaN");return this._s},o.prototype.simpson=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Polynomial.simpson: parameters must be numbers");for(var n=e-t,i=.5*n*(this.eval(t)+this.eval(e)),o=i,r=4*i/3,a=r,s=i,l=1,h=2;h<=20;h++){for(var c=n/l,y=t+.5*c,u=0,p=1;p<=l;p++)u+=this.eval(y),y+=c;if(o=.5*(o+n*u/l),i=o,r=(4*i-s)/3,Math.abs(r-a)<1e-7*Math.abs(a))break;a=r,s=i,l<<=1}return r},o.prototype.romberg=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Polynomial.romberg: parameters must be numbers");var n=new Array(21),i=new Array(21),r={y:0,dy:0};i[0]=1;for(var a=1;a<=20&&(n[a-1]=this.trapezoid(t,e,a),!(a>=3&&(r=o.interpolate(i,n,3,a-3,0),Math.abs(r.dy)<=1e-6*r.y)));a++)n[a]=n[a-1],i[a]=.25*i[a-1];return r.y},o.prototype.getDegree=function(){return this.coefs.length-1},o.prototype.getDerivative=function(){for(var t=new o,e=1;e<this.coefs.length;e++)t.coefs.push(e*this.coefs[e]);return t},o.prototype.getRoots=function(){var t;switch(this.simplify(),this.getDegree()){case 0:t=new Array;break;case 1:t=this.getLinearRoot();break;case 2:t=this.getQuadraticRoots();break;case 3:t=this.getCubicRoots();break;case 4:t=this.getQuarticRoots();break;default:t=new Array}return t},o.prototype.getRootsInInterval=function(t,e){var n,o=new Array;if(1==this.getDegree())null!=(n=this.bisection(t,e))&&o.push(n);else{var r=this.getDerivative(),a=r.getRootsInInterval(t,e);if(a.length>0){for(n=this.bisection(t,a[0]),null!=n&&o.push(n),i=0;i<=a.length-2;i++)null!=(n=this.bisection(a[i],a[i+1]))&&o.push(n);n=this.bisection(a[a.length-1],e),null!=n&&o.push(n)}else null!=(n=this.bisection(t,e))&&o.push(n)}return o},o.prototype.getLinearRoot=function(){var t=new Array,e=this.coefs[1];return 0!=e&&t.push(-this.coefs[0]/e),t},o.prototype.getQuadraticRoots=function(){var t=new Array;if(2==this.getDegree()){var e=this.coefs[2],n=this.coefs[1]/e,i=this.coefs[0]/e,o=n*n-4*i;if(o>0){var r=Math.sqrt(o);t.push(.5*(-n+r)),t.push(.5*(-n-r))}else 0==o&&t.push(.5*-n)}return t},o.prototype.getCubicRoots=function(){var t=new Array;if(3==this.getDegree()){var e=this.coefs[3],n=this.coefs[2]/e,i=this.coefs[1]/e,o=this.coefs[0]/e,r=(3*i-n*n)/3,a=(2*n*n*n-9*i*n+27*o)/27,s=n/3,l=a*a/4+r*r*r/27,h=a/2,c=this.zeroErrorEstimate();if(Math.abs(l)<=c&&(l=0),l>0){var y,u,p=Math.sqrt(l);y=-h+p,u=y>=0?Math.pow(y,1/3):-Math.pow(-y,1/3),y=-h-p,y>=0?u+=Math.pow(y,1/3):u-=Math.pow(-y,1/3),t.push(u-s)}else if(l<0){var d=Math.sqrt(-r/3),f=Math.atan2(Math.sqrt(-l),-h)/3,x=Math.cos(f),v=Math.sin(f),g=Math.sqrt(3);t.push(2*d*x-s),t.push(-d*(x+g*v)-s),t.push(-d*(x-g*v)-s)}else{var y;y=h>=0?-Math.pow(h,1/3):Math.pow(-h,1/3),t.push(2*y-s),t.push(-y-s)}}return t};var r=function(t){return"number"==typeof t?t?t<0?-1:1:t===t?t:NaN:NaN};o.prototype.getQuarticRoots=function(){var t=[],e=this.getDegree();if(4==e){var n=new o;n.coefs=this.coefs.slice(),n.divide_scalar(n.coefs[e]);Math.abs(n.coefs[0])<10*1e-15*Math.abs(n.coefs[3])&&(n.coefs[0]=0);var i,a=n.getDerivative(),s=a.getRoots().sort(function(t,e){return t-e}),l=[],h=s.length-1,c=this.bounds();maxabsX=Math.max(Math.abs(c.minX),Math.abs(c.maxX));var y=this.zeroErrorEstimate(maxabsX);for(i=0;i<=h;i++)l.push(n.eval(s[i]));for(i=0;i<=h;i++)Math.abs(l[i])<y&&(l[i]=0);i=0;var u=Math.max(.1*(c.maxX-c.minX)/e,1e-15),p=[],d=[];if(h>-1){for(0!=l[0]?r(l[0])!=r(n.eval(s[0]-u)-l[0])&&(p.push(s[0]-u),d.push([c.minX,s[0]])):(t.push(s[0],s[0]),i++);i<h;i++)0==l[i+1]?(t.push(s[i+1],s[i+1]),i++):r(l[i])!=r(l[i+1])&&(p.push((s[i]+s[i+1])/2),d.push([s[i],s[i+1]]));0!=l[h]&&r(l[h])!=r(n.eval(s[h]+u)-l[h])&&(p.push(s[h]+u),d.push([s[h],c.maxX]))}var f=function(t){return n.eval(t)},x=function(t){return a.eval(t)};if(p.length>0)for(i=0;i<p.length;i++)p[i]=o.newton_secant_bisection(p[i],f,x,32,d[i][0],d[i][1]);t=t.concat(p)}return t},o.prototype.zeroErrorEstimate=function(t){var e=this;if(void 0===t){var n=e.bounds();t=Math.max(Math.abs(n.minX),Math.abs(n.maxX))}if(t<.001)return 2*Math.abs(e.eval(1e-15));var i=e.coefs.length-1,o=e.coefs[i];return 10*1e-15*e.coefs.reduce(function(e,n,i){var r=n/o*Math.pow(t,i);return r>e?r:e},0)},o.prototype.bounds_UpperReal_Fujiwara=function(){var t=this.coefs,e=t.length-1,n=t[e];1!=n&&(t=this.coefs.map(function(t){return t/n}));var i,o=t.map(function(t,n){return n<e?Math.pow(Math.abs(0==n?t/2:t),1/(e-n)):t}),r=function(t,e,n){return i(n)&&(t.max<e?(t.nearmax=t.max,t.max=e):t.nearmax<e&&(t.nearmax=e)),t};i=function(n){return n<e&&t[n]<0};var a=o.reduce(r,{max:0,nearmax:0});return i=function(n){return n<e&&(e%2==n%2?t[n]<0:t[n]>0)},{negX:-2*o.reduce(r,{max:0,nearmax:0}).max,posX:2*a.max}},o.prototype.bounds_LowerReal_Fujiwara=function(){var t=new o;t.coefs=this.coefs.slice().reverse();var e=t.bounds_UpperReal_Fujiwara();return e.negX=1/e.negX,e.posX=1/e.posX,e},o.prototype.bounds=function(){var t=this.bounds_UpperReal_Fujiwara(),e={minX:t.negX,maxX:t.posX};return 0===t.negX&&0===t.posX?e:(0===t.negX?e.minX=this.bounds_LowerReal_Fujiwara().posX:0===t.posX&&(e.maxX=this.bounds_LowerReal_Fujiwara().negX),e.minX>e.maxX&&(e.minX=e.maxX=0),e)},o.newton_secant_bisection=function(t,e,n,i,o,a){var s,l,h,c,u,p,d=0,f=0;s=t;var x=Math.pow(10,-14),v="number"==typeof o&&"number"==typeof a;if(v){if(o>a)throw new Error("newton root finding: min must be greater than max");if(u=e(o),p=e(a),r(u)==r(p))throw new Error("newton root finding: y values of bounds must be of opposite sign")}var g,m=function(){return Math.abs(h)<=x*Math.abs(s)||f==s-h-s};for(g=0;g<i;g++){if(0==(l=n(s))){if(0==d)throw new Error("newton root finding: df(x) is zero");l=d}if(d=l,y=e(s),h=y/l,c=s-h,m())break;if(v){if(r(y)==r(p))a=s,p=y;else{if(r(y)!=r(u)){s=c;break}o=s,u=y}if(c<o||c>a){if(r(u)==r(p))break;var b=p-u,w=a-o;if(h=0==b?s-(o+.5*w):Math.abs(b/Math.min(u,p))>50?s-(o+w*(.5+(Math.abs(u)<Math.abs(p)?-.25:.25))):s-(o-u/b*w),c=s-h,m())break}}f=s-c,s=c}return s},t.exports=o},17:function(t,e){function n(t,e){for(var n=0;n<t.length;n++){var i=t[n],o=u[i.id];if(o){o.refs++;for(var r=0;r<o.parts.length;r++)o.parts[r](i.parts[r]);for(;r<i.parts.length;r++)o.parts.push(l(i.parts[r],e))}else{for(var a=[],r=0;r<i.parts.length;r++)a.push(l(i.parts[r],e));u[i.id]={id:i.id,refs:1,parts:a}}}}function i(t){for(var e=[],n={},i=0;i<t.length;i++){var o=t[i],r=o[0],a=o[1],s=o[2],l=o[3],h={css:a,media:s,sourceMap:l};n[r]?n[r].parts.push(h):e.push(n[r]={id:r,parts:[h]})}return e}function o(t,e){var n=f(),i=g[g.length-1];if("top"===t.insertAt)i?i.nextSibling?n.insertBefore(e,i.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),g.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(e)}}function r(t){t.parentNode.removeChild(t);var e=g.indexOf(t);e>=0&&g.splice(e,1)}function a(t){var e=document.createElement("style");return e.type="text/css",o(t,e),e}function s(t){var e=document.createElement("link");return e.rel="stylesheet",o(t,e),e}function l(t,e){var n,i,o;if(e.singleton){var l=v++;n=x||(x=a(e)),i=h.bind(null,n,l,!1),o=h.bind(null,n,l,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=s(e),i=y.bind(null,n),o=function(){r(n),n.href&&URL.revokeObjectURL(n.href)}):(n=a(e),i=c.bind(null,n),o=function(){r(n)});return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else o()}}function h(t,e,n,i){var o=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=m(e,o);else{var r=document.createTextNode(o),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(r,a[e]):t.appendChild(r)}}function c(t,e){var n=e.css,i=e.media;if(i&&t.setAttribute("media",i),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function y(t,e){var n=e.css,i=e.sourceMap;i&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var o=new Blob([n],{type:"text/css"}),r=t.href;t.href=URL.createObjectURL(o),r&&URL.revokeObjectURL(r)}var u={},p=function(t){var e;return function(){return void 0===e&&(e=t.apply(this,arguments)),e}},d=p(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),f=p(function(){return document.head||document.getElementsByTagName("head")[0]}),x=null,v=0,g=[];t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");e=e||{},void 0===e.singleton&&(e.singleton=d()),void 0===e.insertAt&&(e.insertAt="bottom");var o=i(t);return n(o,e),function(t){for(var r=[],a=0;a<o.length;a++){var s=o[a],l=u[s.id];l.refs--,r.push(l)}if(t){n(i(t),e)}for(var a=0;a<r.length;a++){var l=r[a];if(0===l.refs){for(var h=0;h<l.parts.length;h++)l.parts[h]();delete u[l.id]}}}};var m=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},18:function(t,e,n){"use strict";e.Point2D=n(206),e.Vector2D=n(207),e.Matrix2D=n(205)},196:function(t,e,n){"use strict";var i=n(210),o=function(t){return t&&t.__esModule?t:{default:t}}(i);window.AppsTopology=o.default},20:function(t,e,n){"use strict";e.Intersection=n(208),e.IntersectionParams=n(112)},205:function(t,e,n){"use strict";function i(t,e,n,i,o,r){Object.defineProperties(this,{a:{value:void 0!==t?t:1,writable:!1,enumerable:!0,configurable:!1},b:{value:void 0!==e?e:0,writable:!1,enumerable:!0,configurable:!1},c:{value:void 0!==n?n:0,writable:!1,enumerable:!0,configurable:!1},d:{value:void 0!==i?i:1,writable:!1,enumerable:!0,configurable:!1},e:{value:void 0!==o?o:0,writable:!1,enumerable:!0,configurable:!1},f:{value:void 0!==r?r:0,writable:!1,enumerable:!0,configurable:!1}})}i.IDENTITY=new i(1,0,0,1,0,0),i.IDENTITY.isIdentity=function(){return!0},i.prototype.multiply=function(t){return this.isIdentity()?t:t.isIdentity()?this:new this.constructor(this.a*t.a+this.c*t.b,this.b*t.a+this.d*t.b,this.a*t.c+this.c*t.d,this.b*t.c+this.d*t.d,this.a*t.e+this.c*t.f+this.e,this.b*t.e+this.d*t.f+this.f)},i.prototype.inverse=function(){if(this.isIdentity())return this;var t=this.a*this.d-this.b*this.c;if(0===t)throw"Matrix is not invertible";var e=1/t,n=this.f*this.c-this.e*this.d,i=this.e*this.b-this.f*this.a;return new this.constructor(this.d*e,-this.b*e,-this.c*e,this.a*e,n*e,i*e)},i.prototype.translate=function(t,e){return new this.constructor(this.a,this.b,this.c,this.d,this.a*t+this.c*e+this.e,this.b*t+this.d*e+this.f)},i.prototype.scale=function(t){return new this.constructor(this.a*t,this.b*t,this.c*t,this.d*t,this.e,this.f)},i.prototype.scaleAt=function(t,e){var n=e.x-t*e.x,i=e.y-t*e.y;return new this.constructor(this.a*t,this.b*t,this.c*t,this.d*t,this.a*n+this.c*i+this.e,this.b*n+this.d*i+this.f)},i.prototype.scaleNonUniform=function(t,e){return new this.constructor(this.a*t,this.b*t,this.c*e,this.d*e,this.e,this.f)},i.prototype.scaleNonUniformAt=function(t,e,n){var i=n.x-t*n.x,o=n.y-e*n.y;return new this.constructor(this.a*t,this.b*t,this.c*e,this.d*e,this.a*i+this.c*o+this.e,this.b*i+this.d*o+this.f)},i.prototype.rotate=function(t){var e=Math.cos(t),n=Math.sin(t);return new this.constructor(this.a*e+this.c*n,this.b*e+this.d*n,this.a*-n+this.c*e,this.b*-n+this.d*e,this.e,this.f)},i.prototype.rotateAt=function(t,e){var n=Math.cos(t),i=Math.sin(t),o=-e.x+e.x*n-e.y*i,r=-e.y+e.y*n+e.x*i;return new this.constructor(this.a*n+this.c*i,this.b*n+this.d*i,this.a*-i+this.c*n,this.b*-i+this.d*n,this.a*o+this.c*r+this.e,this.b*o+this.d*r+this.f)},i.prototype.rotateFromVector=function(t){var e=t.unit(),n=e.x,i=e.y;return new this.constructor(this.a*n+this.c*i,this.b*n+this.d*i,this.a*-i+this.c*n,this.b*-i+this.d*n,this.e,this.f)},i.prototype.flipX=function(){return new this.constructor(-this.a,-this.b,this.c,this.d,this.e,this.f)},i.prototype.flipY=function(){return new this.constructor(this.a,this.b,-this.c,-this.d,this.e,this.f)},i.prototype.skewX=function(t){var e=Math.tan(t);return new this.constructor(this.a,this.b,this.a*e+this.c,this.b*e+this.d,this.e,this.f)},i.prototype.skewY=function(t){var e=Math.tan(t);return new this.constructor(this.a+this.c*e,this.b+this.d*e,this.c,this.d,this.e,this.f)},i.prototype.isIdentity=function(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d&&0===this.e&&0===this.f},i.prototype.isInvertible=function(){return this.a*this.d-this.b*this.c!=0},i.prototype.getScale=function(){return{scaleX:Math.sqrt(this.a*this.a+this.c*this.c),scaleY:Math.sqrt(this.b*this.b+this.d*this.d)}},i.prototype.getDecompositionTRSR=function(){var t=this.a,e=this.b,n=this.c,i=this.d,o=(t+i)/2,r=(t-i)/2,a=(e+n)/2,s=(e-n)/2,l=Math.sqrt(o*o+s*s),h=Math.sqrt(r*r+a*a),c=l+h,y=l-h,u=Math.atan2(a,r),p=Math.atan2(s,o),d=(p-u)/2,f=(p+u)/2;return{T:new this.constructor(1,0,0,1,this.e,this.f),R:this.constructor.IDENTITY.rotate(f),S:new this.constructor(c,0,0,y,0,0),R0:this.constructor.IDENTITY.rotate(d)}},i.prototype.equals=function(t){return this.a===t.a&&this.b===t.b&&this.c===t.c&&this.d===t.d&&this.e===t.e&&this.f===t.f},i.prototype.toString=function(){return"matrix("+this.a+","+this.b+","+this.c+","+this.d+","+this.e+","+this.f+")"},t.exports=i},206:function(t,e,n){"use strict";function i(t,e){Object.defineProperties(this,{x:{value:t,writable:!1,enumerable:!0,configurable:!1},y:{value:e,writable:!1,enumerable:!0,configurable:!1}})}i.prototype.clone=function(){return new this.constructor(this.x,this.y)},i.prototype.add=function(t){return new this.constructor(this.x+t.x,this.y+t.y)},i.prototype.subtract=function(t){return new this.constructor(this.x-t.x,this.y-t.y)},i.prototype.multiply=function(t){return new this.constructor(this.x*t,this.y*t)},i.prototype.divide=function(t){return new this.constructor(this.x/t,this.y/t)},i.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},i.prototype.lerp=function(t,e){var n=1-e;return new this.constructor(this.x*n+t.x*e,this.y*n+t.y*e)},i.prototype.distanceFrom=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},i.prototype.min=function(t){return new this.constructor(Math.min(this.x,t.x),Math.min(this.y,t.y))},i.prototype.max=function(t){return new this.constructor(Math.max(this.x,t.x),Math.max(this.y,t.y))},i.prototype.transform=function(t){return new this.constructor(t.a*this.x+t.c*this.y+t.e,t.b*this.x+t.d*this.y+t.f)},i.prototype.toString=function(){return"point("+this.x+","+this.y+")"},t.exports=i},207:function(t,e,n){"use strict";function i(t,e){Object.defineProperties(this,{x:{value:t,writable:!1,enumerable:!0,configurable:!1},y:{value:e,writable:!1,enumerable:!0,configurable:!1}})}i.fromPoints=function(t,e){return new i(e.x-t.x,e.y-t.y)},i.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},i.prototype.magnitude=function(){return this.x*this.x+this.y*this.y},i.prototype.dot=function(t){return this.x*t.x+this.y*t.y},i.prototype.cross=function(t){return this.x*t.y-this.y*t.x},i.prototype.determinant=function(t){return this.x*t.y-this.y*t.x},i.prototype.unit=function(){return this.divide(this.length())},i.prototype.add=function(t){return new this.constructor(this.x+t.x,this.y+t.y)},i.prototype.subtract=function(t){return new this.constructor(this.x-t.x,this.y-t.y)},i.prototype.multiply=function(t){return new this.constructor(this.x*t,this.y*t)},i.prototype.divide=function(t){return new this.constructor(this.x/t,this.y/t)},i.prototype.angleBetween=function(t){var e=this.dot(t)/(this.length()*t.length());e=Math.max(-1,Math.min(e,1));var n=Math.acos(e);return this.cross(t)<0?-n:n},i.prototype.perp=function(){return new this.constructor(-this.y,this.x)},i.prototype.perpendicular=function(t){return this.subtract(this.project(t))},i.prototype.project=function(t){var e=this.dot(t)/t.dot(t);return t.multiply(e)},i.prototype.transform=function(t){return new this.constructor(t.a*this.x+t.c*this.y,t.b*this.x+t.d*this.y)},i.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},i.prototype.toString=function(){return"vector("+this.x+","+this.y+")"},t.exports=i},208:function(t,e,n){"use strict";(function(t){var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};/**
 *
 *  Intersection.js
 *
 *  copyright 2002, 2013 Kevin Lindsey
 *
 *  contribution {@link http://github.com/Quazistax/kld-intersections}
 *      @copyright 2015 Robert Benko (Quazistax) <quazistax@gmail.com>
 *      @license MIT
 */
!function(i,o){if("object"===e(t)&&"object"===e(t.exports)){var r=n(18);t.exports=o(r.Point2D,r.Vector2D,r.Matrix2D,n(517).Polynomial,n(112))}else i.Intersection=o(Point2D,Vector2D,Matrix2D,Polynomial,IntersectionParams)}(void 0,function(t,e,n,i,o){function r(t){this.init(t)}return r.prototype.init=function(t){this.status=t,this.points=[]},r.prototype.appendPoint=function(t){this.points.push(t)},r.prototype.appendPoints=function(t){this.points=this.points.concat(t)},r.intersectShapes=function(e,i,a,s){var l,h=e,c=i,y=o.TYPE,u=r.intersectShapes;if(u.composedShapeMethods||(u.composedShapeMethods={},u.composedShapeMethods[y.PATH]=r.intersectPathShape,u.composedShapeMethods[y.POLYLINE]=r.intersectLinesShape,u.composedShapeMethods[y.POLYGON]=r.intersectLinesShape,u.composedShapeMethods[y.RECT]=r.intersectLinesShape,u.composedShapeMethods[y.ROUNDRECT]=r.intersectPathShape,u.composedShapeMethods[y.ARC]=r.intersectArcShape),null!==h&&null!==c){var p;if(p=u.composedShapeMethods[h.type])l=p(h,c,a,s);else if(p=u.composedShapeMethods[c.type])l=p(c,h,s,a);else{var d,f,x,v,g;h.type===y.CIRCLE?(f=[h.params[0],h.params[1],h.params[1]],v=y.ELLIPSE):(f=h.params.slice(),v=h.type),c.type===y.CIRCLE?(x=[c.params[0],c.params[1],c.params[1]],g=y.ELLIPSE):(x=c.params.slice(),g=c.type);var m,b=a instanceof n&&s instanceof n;if(b)if(v===y.ELLIPSE&&g===y.ELLIPSE){var w,k,_,E=f[0],M=f[1],P=f[2],T=x[0],I=x[1],A=x[2];a=a.multiply(n.IDENTITY.translate(E.x,E.y).scaleNonUniform(M/1,P/1)),E=new t(0,0),M=P=1,s=s.multiply(n.IDENTITY.translate(T.x,T.y).scaleNonUniform(I,A)),T=new t(0,0),I=A=1,_=a.inverse().multiply(s).getDecompositionTRSR(),w=_.R.inverse().multiply(_.T.inverse()),k=_.S,I=k.a,A=k.d,E=E.transform(w),m=a.multiply(w.inverse()),f[0]=E,f[1]=M,f[2]=P,x[0]=T,x[1]=I,x[2]=A}else{var N=function(t,e,n){var i=function(t){e[t]=e[t].transform(n)};if(t===y.LINE)i(0),i(1);else if(t===y.BEZIER2)i(0),i(1),i(2);else{if(t!==y.BEZIER3)throw console.log("Unknown shape: "+t),new Error("Unknown shape: "+t);i(0),i(1),i(2),i(3)}};if(g===y.ELLIPSE){var R;R=x,x=f,f=R,R=g,g=v,v=R,R=s,s=a,a=R}if(v===y.ELLIPSE){var E=f[0],M=f[1],P=f[2];a=a.multiply(n.IDENTITY.translate(E.x,E.y).scaleNonUniform(M/1,P/1)),E=new t(0,0),M=P=1,k=a.inverse().multiply(s),N(g,x,k),m=a,f[0]=E,f[1]=M,f[2]=P}else N(v,f,a),N(g,x,s),m=n.IDENTITY}if(v<g?(p="intersect"+v+g,d=f.concat(x)):(p="intersect"+g+v,d=x.concat(f)),!(p in r))throw new Error("Intersection not available: "+p);if(l=r[p].apply(null,d),b)for(var C=0;C<l.points.length;C++)l.points[C]=l.points[C].transform(m)}}else l=new r;return l},r.intersectPathShape=function(t,e,n,i){for(var o,a,s,l=new r,h=t.params[0],c=0;c<h.length;c++)s=r.intersectShapes(h[c],e,n,i),o||(o=s),a&&(r.Utils.removeClosePoints(a.points,s.points),l.appendPoints(a.points)),a=s;return a&&l.appendPoints(a.points),l},r.intersectLinesShape=function(t,e,n,i,a){var s,l,h=o.TYPE,c=t.params[0],y=new o(h.LINE,[0,0]),u=new r,p=function(t,o){y.params[0]=c[t],y.params[1]=c[o],s=r.intersectShapes(y,e,n,i),r.Utils.removeClosePoints(s.points,[c[o]]),u.appendPoints(s.points)};for(l=0;l<c.length-1;l++)p(l,l+1);return(void 0!==a&&a||t.type===h.RECT||t.type===h.POLYGON)&&p(c.length-1,0),u},r.intersectArcShape=function(e,i,a,s){a=a||n.IDENTITY,s=s||n.IDENTITY;var l,h=e.params[0],c=e.params[1],y=e.params[2],u=e.params[3],p=e.params[4],d=e.params[5];return a.isIdentity()&&0===u?l=r.intersectShapes(o.newEllipse(h,c,y),i,a,s):(a=a.multiply(n.IDENTITY.translate(h.x,h.y).rotate(u)),h=new t(0,0),u=0,l=r.intersectShapes(o.newEllipse(h,c,y),i,a,s)),l=r.Utils.removePointsNotInArc(l,h,c,y,u,p,d,a)},r.intersectBezier2Bezier2=function(e,n,o,a,s,l){var h,c,y,u,p,d,f,x,v,g=new r;h=n.multiply(-2),y=e.add(h.add(o)),h=e.multiply(-2),c=n.multiply(2),u=h.add(c),p=new t(e.x,e.y),h=s.multiply(-2),d=a.add(h.add(l)),h=a.multiply(-2),c=s.multiply(2),f=h.add(c),x=new t(a.x,a.y);var m,b,w,k,_,E,M;0===y.y?(m=y.x*(p.y-x.y),b=m-u.x*u.y,w=m+b,k=u.y*u.y,v=new i(y.x*d.y*d.y,2*y.x*f.y*d.y,y.x*f.y*f.y-d.x*k-d.y*m-d.y*b,-f.x*k-f.y*m-f.y*b,(p.x-x.x)*k+(p.y-x.y)*b)):(m=y.x*d.y-y.y*d.x,b=y.x*f.y-f.x*y.y,w=u.x*y.y-u.y*y.x,k=p.y-x.y,_=y.y*(p.x-x.x)-y.x*k,E=-u.y*w+y.y*_,M=w*w,v=new i(m*m,2*m*b,(-d.y*M+y.y*b*b+y.y*m*_+m*E)/y.y,(-f.y*M+y.y*b*_+b*E)/y.y,(k*M+_*E)/y.y));for(var P=v.getRoots(),T=0;T<P.length;T++){var I=P[T];if(0<=I&&I<=1){var A=new i(y.x,u.x,p.x-x.x-I*f.x-I*I*d.x).getRoots(),N=new i(y.y,u.y,p.y-x.y-I*f.y-I*I*d.y).getRoots();if(A.length>0&&N.length>0){t:for(var R=0;R<A.length;R++){var C=A[R];if(0<=C&&C<=1)for(var S=0;S<N.length;S++)if(Math.abs(C-N[S])<1e-4){g.points.push(d.multiply(I*I).add(f.multiply(I).add(x)));break t}}}}}return g},r.intersectBezier2Bezier3=function(n,o,a,s,l,h,c){var y,u,p,d,f,x,v,g,m,b,w,k=new r;y=o.multiply(-2),f=n.add(y.add(a)),y=n.multiply(-2),u=o.multiply(2),x=y.add(u),v=new t(n.x,n.y),y=s.multiply(-1),u=l.multiply(3),p=h.multiply(-3),d=y.add(u.add(p.add(c))),g=new e(d.x,d.y),y=s.multiply(3),u=l.multiply(-6),p=h.multiply(3),d=y.add(u.add(p)),m=new e(d.x,d.y),y=s.multiply(-3),u=l.multiply(3),p=y.add(u),b=new e(p.x,p.y),w=new e(s.x,s.y);var _=v.x*v.x,E=v.y*v.y,M=x.x*x.x,P=x.y*x.y,T=f.x*f.x,I=f.y*f.y,A=w.x*w.x,N=w.y*w.y,R=b.x*b.x,C=b.y*b.y,S=m.x*m.x,O=m.y*m.y,L=g.x*g.x,D=g.y*g.y,j=new i(-2*f.x*f.y*g.x*g.y+T*D+I*L,-2*f.x*f.y*m.x*g.y-2*f.x*f.y*m.y*g.x+2*I*m.x*g.x+2*T*m.y*g.y,-2*f.x*b.x*f.y*g.y-2*f.x*f.y*b.y*g.x-2*f.x*f.y*m.x*m.y+2*b.x*I*g.x+I*S+T*(2*b.y*g.y+O),2*v.x*f.x*f.y*g.y+2*v.y*f.x*f.y*g.x+x.x*x.y*f.x*g.y+x.x*x.y*f.y*g.x-2*w.x*f.x*f.y*g.y-2*f.x*w.y*f.y*g.x-2*f.x*b.x*f.y*m.y-2*f.x*f.y*b.y*m.x-2*v.x*I*g.x-2*v.y*T*g.y+2*w.x*I*g.x+2*b.x*I*m.x-P*f.x*g.x-M*f.y*g.y+T*(2*w.y*g.y+2*b.y*m.y),2*v.x*f.x*f.y*m.y+2*v.y*f.x*f.y*m.x+x.x*x.y*f.x*m.y+x.x*x.y*f.y*m.x-2*w.x*f.x*f.y*m.y-2*f.x*w.y*f.y*m.x-2*f.x*b.x*f.y*b.y-2*v.x*I*m.x-2*v.y*T*m.y+2*w.x*I*m.x-P*f.x*m.x-M*f.y*m.y+R*I+T*(2*w.y*m.y+C),2*v.x*f.x*f.y*b.y+2*v.y*f.x*b.x*f.y+x.x*x.y*f.x*b.y+x.x*x.y*b.x*f.y-2*w.x*f.x*f.y*b.y-2*f.x*w.y*b.x*f.y-2*v.x*b.x*I-2*v.y*T*b.y+2*w.x*b.x*I-P*f.x*b.x-M*f.y*b.y+2*T*w.y*b.y,-2*v.x*v.y*f.x*f.y-v.x*x.x*x.y*f.y-v.y*x.x*x.y*f.x+2*v.x*f.x*w.y*f.y+2*v.y*w.x*f.x*f.y+x.x*w.x*x.y*f.y+x.x*x.y*f.x*w.y-2*w.x*f.x*w.y*f.y-2*v.x*w.x*I+v.x*P*f.x+v.y*M*f.y-2*v.y*T*w.y-w.x*P*f.x-M*w.y*f.y+_*I+E*T+A*I+T*N),z=j.getRootsInInterval(0,1);r.Utils.removeMultipleRootsIn01(z);for(var B=0;B<z.length;B++){var U=z[B],q=new i(f.x,x.x,v.x-w.x-U*b.x-U*U*m.x-U*U*U*g.x).getRoots(),X=new i(f.y,x.y,v.y-w.y-U*b.y-U*U*m.y-U*U*U*g.y).getRoots();if(q.length>0&&X.length>0){t:for(var Y=0;Y<q.length;Y++){var H=q[Y];if(0<=H&&H<=1)for(var G=0;G<X.length;G++)if(Math.abs(H-X[G])<1e-4){var F=g.multiply(U*U*U).add(m.multiply(U*U).add(b.multiply(U).add(w)));k.points.push(new t(F.x,F.y));break t}}}}return k},r.intersectBezier2Ellipse=function(e,n,o,a,s,l){var h,c,y,u,p,d=new r;h=n.multiply(-2),y=e.add(h.add(o)),h=e.multiply(-2),c=n.multiply(2),u=h.add(c),p=new t(e.x,e.y);for(var f=s*s,x=l*l,v=new i(x*y.x*y.x+f*y.y*y.y,2*(x*y.x*u.x+f*y.y*u.y),x*(2*y.x*p.x+u.x*u.x)+f*(2*y.y*p.y+u.y*u.y)-2*(x*a.x*y.x+f*a.y*y.y),2*(x*u.x*(p.x-a.x)+f*u.y*(p.y-a.y)),x*(p.x*p.x+a.x*a.x)+f*(p.y*p.y+a.y*a.y)-2*(x*a.x*p.x+f*a.y*p.y)-f*x).getRoots(),g=0;g<v.length;g++){var m=v[g];0<=m&&m<=1&&d.points.push(y.multiply(m*m).add(u.multiply(m).add(p)))}return d},r.intersectBezier2Line=function(n,o,a,s,l){var h,c,y,u,p,d,f,x=s.min(l),v=s.max(l),g=new r;h=o.multiply(-2),y=n.add(h.add(a)),h=n.multiply(-2),c=o.multiply(2),u=h.add(c),p=new t(n.x,n.y),f=new e(s.y-l.y,l.x-s.x),d=s.x*l.y-l.x*s.y,roots=new i(f.dot(y),f.dot(u),f.dot(p)+d).getRoots();for(var m=0;m<roots.length;m++){var b=roots[m];if(0<=b&&b<=1){var w=n.lerp(o,b),k=o.lerp(a,b),_=w.lerp(k,b);s.x==l.x?x.y<=_.y&&_.y<=v.y&&g.appendPoint(_):s.y==l.y?x.x<=_.x&&_.x<=v.x&&g.appendPoint(_):x.x<=_.x&&_.x<=v.x&&x.y<=_.y&&_.y<=v.y&&g.appendPoint(_)}}return g},r.intersectBezier3Bezier3=function(n,o,a,s,l,h,c,y){var u,p,d,f,x,v,g,m,b,w,k,_,E=new r;u=n.multiply(-1),p=o.multiply(3),d=a.multiply(-3),f=u.add(p.add(d.add(s))),x=new e(f.x,f.y),u=n.multiply(3),p=o.multiply(-6),d=a.multiply(3),f=u.add(p.add(d)),v=new e(f.x,f.y),u=n.multiply(-3),p=o.multiply(3),d=u.add(p),g=new e(d.x,d.y),m=new e(n.x,n.y),u=l.multiply(-1),p=h.multiply(3),d=c.multiply(-3),f=u.add(p.add(d.add(y))),b=new e(f.x,f.y),u=l.multiply(3),p=h.multiply(-6),d=c.multiply(3),f=u.add(p.add(d)),w=new e(f.x,f.y),u=l.multiply(-3),p=h.multiply(3),d=u.add(p),k=new e(d.x,d.y),_=new e(l.x,l.y);var M=m.x*m.x,P=m.x*m.x*m.x,T=m.y*m.y,I=m.y*m.y*m.y,A=g.x*g.x,N=g.x*g.x*g.x,R=g.y*g.y,C=g.y*g.y*g.y,S=v.x*v.x,O=v.x*v.x*v.x,L=v.y*v.y,D=v.y*v.y*v.y,j=x.x*x.x,z=x.x*x.x*x.x,B=x.y*x.y,U=x.y*x.y*x.y,q=_.x*_.x,X=_.x*_.x*_.x,Y=_.y*_.y,H=_.y*_.y*_.y,G=k.x*k.x,F=k.x*k.x*k.x,V=k.y*k.y,Z=w.x*w.x,K=w.x*w.x*w.x,W=w.y*w.y,Q=b.x*b.x,J=b.x*b.x*b.x,$=b.y*b.y,tt=b.y*b.y*b.y,et=new i(-z*tt+U*J-3*x.x*B*Q*b.y+3*j*x.y*b.x*$,-6*x.x*w.x*B*b.x*b.y+6*j*x.y*w.y*b.x*b.y+3*w.x*U*Q-3*z*w.y*$-3*x.x*B*w.y*Q+3*j*w.x*x.y*$,-6*k.x*x.x*B*b.x*b.y-6*x.x*w.x*B*w.y*b.x+6*j*w.x*x.y*w.y*b.y+3*k.x*U*Q+3*Z*U*b.x+3*k.x*j*x.y*$-3*x.x*k.y*B*Q-3*x.x*Z*B*b.y+j*x.y*b.x*(6*k.y*b.y+3*W)+z*(-k.y*$-2*W*b.y-b.y*(2*k.y*b.y+W)),g.x*v.y*x.x*x.y*b.x*b.y-g.y*v.x*x.x*x.y*b.x*b.y+6*k.x*w.x*U*b.x+3*g.x*v.x*x.x*x.y*$+6*m.x*x.x*B*b.x*b.y-3*g.x*v.x*B*b.x*b.y-3*g.y*v.y*x.x*x.y*Q-6*m.y*j*x.y*b.x*b.y-6*_.x*x.x*B*b.x*b.y+3*g.y*v.y*j*b.x*b.y-2*v.x*L*x.x*b.x*b.y-6*k.x*x.x*w.x*B*b.y-6*k.x*x.x*B*w.y*b.x-6*x.x*k.y*w.x*B*b.x+6*k.x*j*x.y*w.y*b.y+2*S*v.y*x.y*b.x*b.y+K*U-3*m.x*U*Q+3*m.y*z*$+3*_.x*U*Q+D*x.x*Q-O*x.y*$-3*m.x*j*x.y*$+3*m.y*x.x*B*Q-2*g.x*v.y*j*$+g.x*v.y*B*Q-g.y*v.x*j*$+2*g.y*v.x*B*Q+3*_.x*j*x.y*$-v.x*L*x.y*Q-3*_.y*x.x*B*Q+S*v.y*x.x*$-3*x.x*Z*B*w.y+j*x.y*b.x*(6*_.y*b.y+6*k.y*w.y)+j*w.x*x.y*(6*k.y*b.y+3*W)+z*(-2*k.y*w.y*b.y-_.y*$-w.y*(2*k.y*b.y+W)-b.y*(2*_.y*b.y+2*k.y*w.y)),6*g.x*v.x*x.x*x.y*w.y*b.y+g.x*v.y*x.x*w.x*x.y*b.y+g.x*v.y*x.x*x.y*w.y*b.x-g.y*v.x*x.x*w.x*x.y*b.y-g.y*v.x*x.x*x.y*w.y*b.x-6*g.y*v.y*x.x*w.x*x.y*b.x-6*m.x*w.x*U*b.x+6*_.x*w.x*U*b.x+6*m.y*z*w.y*b.y+2*D*x.x*w.x*b.x-2*O*x.y*w.y*b.y+6*m.x*x.x*w.x*B*b.y+6*m.x*x.x*B*w.y*b.x+6*m.y*x.x*w.x*B*b.x-3*g.x*v.x*w.x*B*b.y-3*g.x*v.x*B*w.y*b.x+2*g.x*v.y*w.x*B*b.x+4*g.y*v.x*w.x*B*b.x-6*m.x*j*x.y*w.y*b.y-6*m.y*j*w.x*x.y*b.y-6*m.y*j*x.y*w.y*b.x-4*g.x*v.y*j*w.y*b.y-6*_.x*x.x*w.x*B*b.y-6*_.x*x.x*B*w.y*b.x-2*g.y*v.x*j*w.y*b.y+3*g.y*v.y*j*w.x*b.y+3*g.y*v.y*j*w.y*b.x-2*v.x*L*x.x*w.x*b.y-2*v.x*L*x.x*w.y*b.x-2*v.x*L*w.x*x.y*b.x-6*_.y*x.x*w.x*B*b.x-6*k.x*x.x*k.y*B*b.x-6*k.x*x.x*w.x*B*w.y+6*_.x*j*x.y*w.y*b.y+2*S*v.y*x.x*w.y*b.y+2*S*v.y*w.x*x.y*b.y+2*S*v.y*x.y*w.y*b.x+3*k.x*Z*U+3*G*U*b.x-3*x.x*k.y*Z*B-3*G*x.x*B*b.y+j*w.x*x.y*(6*_.y*b.y+6*k.y*w.y)+j*x.y*b.x*(6*_.y*w.y+3*V)+k.x*j*x.y*(6*k.y*b.y+3*W)+z*(-2*_.y*w.y*b.y-b.y*(2*_.y*w.y+V)-k.y*(2*k.y*b.y+W)-w.y*(2*_.y*b.y+2*k.y*w.y)),g.x*k.x*v.y*x.x*x.y*b.y+g.x*v.y*x.x*k.y*x.y*b.x+g.x*v.y*x.x*w.x*x.y*w.y-g.y*v.x*k.x*x.x*x.y*b.y-g.y*v.x*x.x*k.y*x.y*b.x-g.y*v.x*x.x*w.x*x.y*w.y-6*g.y*k.x*v.y*x.x*x.y*b.x-6*m.x*k.x*U*b.x+6*_.x*k.x*U*b.x+2*k.x*D*x.x*b.x+6*m.x*k.x*x.x*B*b.y+6*m.x*x.x*k.y*B*b.x+6*m.x*x.x*w.x*B*w.y+6*m.y*k.x*x.x*B*b.x-3*g.x*v.x*k.x*B*b.y-3*g.x*v.x*k.y*B*b.x-3*g.x*v.x*w.x*B*w.y+2*g.x*k.x*v.y*B*b.x+4*g.y*v.x*k.x*B*b.x-6*m.y*k.x*j*x.y*b.y-6*m.y*j*k.y*x.y*b.x-6*m.y*j*w.x*x.y*w.y-6*_.x*k.x*x.x*B*b.y-6*_.x*x.x*k.y*B*b.x-6*_.x*x.x*w.x*B*w.y+3*g.y*k.x*v.y*j*b.y-3*g.y*v.y*x.x*Z*x.y+3*g.y*v.y*j*k.y*b.x+3*g.y*v.y*j*w.x*w.y-2*v.x*k.x*L*x.x*b.y-2*v.x*k.x*L*x.y*b.x-2*v.x*L*x.x*k.y*b.x-2*v.x*L*x.x*w.x*w.y-6*_.y*k.x*x.x*B*b.x-6*k.x*x.x*k.y*w.x*B+6*_.y*j*k.y*x.y*b.x+2*S*k.x*v.y*x.y*b.y+2*S*v.y*k.y*x.y*b.x+2*S*v.y*w.x*x.y*w.y-3*m.x*Z*U+3*_.x*Z*U+3*G*w.x*U+D*x.x*Z+3*m.y*x.x*Z*B+g.x*v.y*Z*B+2*g.y*v.x*Z*B-v.x*L*Z*x.y-3*_.y*x.x*Z*B-3*G*x.x*B*w.y+S*v.y*x.x*(2*k.y*b.y+W)+g.x*v.x*x.x*x.y*(6*k.y*b.y+3*W)+k.x*j*x.y*(6*_.y*b.y+6*k.y*w.y)+O*x.y*(-2*k.y*b.y-W)+m.y*z*(6*k.y*b.y+3*W)+g.y*v.x*j*(-2*k.y*b.y-W)+g.x*v.y*j*(-4*k.y*b.y-2*W)+m.x*j*x.y*(-6*k.y*b.y-3*W)+j*w.x*x.y*(6*_.y*w.y+3*V)+_.x*j*x.y*(6*k.y*b.y+3*W)+z*(-2*_.y*k.y*b.y-w.y*(2*_.y*w.y+V)-_.y*(2*k.y*b.y+W)-k.y*(2*_.y*b.y+2*k.y*w.y)),-m.x*g.x*v.y*x.x*x.y*b.y+m.x*g.y*v.x*x.x*x.y*b.y+6*m.x*g.y*v.y*x.x*x.y*b.x-6*m.y*g.x*v.x*x.x*x.y*b.y-m.y*g.x*v.y*x.x*x.y*b.x+m.y*g.y*v.x*x.x*x.y*b.x+g.x*g.y*v.x*v.y*x.x*b.y-g.x*g.y*v.x*v.y*x.y*b.x+g.x*_.x*v.y*x.x*x.y*b.y+g.x*_.y*v.y*x.x*x.y*b.x+g.x*k.x*v.y*x.x*x.y*w.y+g.x*v.y*x.x*k.y*w.x*x.y-_.x*g.y*v.x*x.x*x.y*b.y-6*_.x*g.y*v.y*x.x*x.y*b.x-g.y*v.x*_.y*x.x*x.y*b.x-g.y*v.x*k.x*x.x*x.y*w.y-g.y*v.x*x.x*k.y*w.x*x.y-6*g.y*k.x*v.y*x.x*w.x*x.y-6*m.x*_.x*U*b.x-6*m.x*k.x*w.x*U-2*m.x*D*x.x*b.x+6*_.x*k.x*w.x*U+2*_.x*D*x.x*b.x+2*k.x*D*x.x*w.x+2*m.y*O*x.y*b.y-6*m.x*m.y*x.x*B*b.x+3*m.x*g.x*v.x*B*b.y-2*m.x*g.x*v.y*B*b.x-4*m.x*g.y*v.x*B*b.x+3*m.y*g.x*v.x*B*b.x+6*m.x*m.y*j*x.y*b.y+6*m.x*_.x*x.x*B*b.y-3*m.x*g.y*v.y*j*b.y+2*m.x*v.x*L*x.x*b.y+2*m.x*v.x*L*x.y*b.x+6*m.x*_.y*x.x*B*b.x+6*m.x*k.x*x.x*B*w.y+6*m.x*x.x*k.y*w.x*B+4*m.y*g.x*v.y*j*b.y+6*m.y*_.x*x.x*B*b.x+2*m.y*g.y*v.x*j*b.y-3*m.y*g.y*v.y*j*b.x+2*m.y*v.x*L*x.x*b.x+6*m.y*k.x*x.x*w.x*B-3*g.x*_.x*v.x*B*b.y+2*g.x*_.x*v.y*B*b.x+g.x*g.y*L*x.x*b.x-3*g.x*v.x*_.y*B*b.x-3*g.x*v.x*k.x*B*w.y-3*g.x*v.x*k.y*w.x*B+2*g.x*k.x*v.y*w.x*B+4*_.x*g.y*v.x*B*b.x+4*g.y*v.x*k.x*w.x*B-2*m.x*S*v.y*x.y*b.y-6*m.y*_.x*j*x.y*b.y-6*m.y*_.y*j*x.y*b.x-6*m.y*k.x*j*x.y*w.y-2*m.y*S*v.y*x.x*b.y-2*m.y*S*v.y*x.y*b.x-6*m.y*j*k.y*w.x*x.y-g.x*g.y*S*x.y*b.y-2*g.x*R*x.x*x.y*b.x+3*_.x*g.y*v.y*j*b.y-2*_.x*v.x*L*x.x*b.y-2*_.x*v.x*L*x.y*b.x-6*_.x*_.y*x.x*B*b.x-6*_.x*k.x*x.x*B*w.y-6*_.x*x.x*k.y*w.x*B+3*g.y*_.y*v.y*j*b.x+3*g.y*k.x*v.y*j*w.y+3*g.y*v.y*j*k.y*w.x-2*v.x*_.y*L*x.x*b.x-2*v.x*k.x*L*x.x*w.y-2*v.x*k.x*L*w.x*x.y-2*v.x*L*x.x*k.y*w.x-6*_.y*k.x*x.x*w.x*B-R*v.x*v.y*x.x*b.x+2*_.x*S*v.y*x.y*b.y+6*_.y*j*k.y*w.x*x.y+2*A*g.y*x.x*x.y*b.y+A*v.x*v.y*x.y*b.y+2*S*_.y*v.y*x.y*b.x+2*S*k.x*v.y*x.y*w.y+2*S*v.y*k.y*w.x*x.y+F*U+3*M*U*b.x-3*T*z*b.y+3*q*U*b.x+C*j*b.x-N*B*b.y-g.x*R*j*b.y+A*g.y*B*b.x-3*M*x.x*B*b.y+3*T*j*x.y*b.x-A*L*x.x*b.y+R*S*x.y*b.x-3*G*x.x*k.y*B-3*q*x.x*B*b.y+3*Y*j*x.y*b.x+g.x*v.x*x.x*x.y*(6*_.y*b.y+6*k.y*w.y)+O*x.y*(-2*_.y*b.y-2*k.y*w.y)+m.y*z*(6*_.y*b.y+6*k.y*w.y)+g.y*v.x*j*(-2*_.y*b.y-2*k.y*w.y)+S*v.y*x.x*(2*_.y*b.y+2*k.y*w.y)+g.x*v.y*j*(-4*_.y*b.y-4*k.y*w.y)+m.x*j*x.y*(-6*_.y*b.y-6*k.y*w.y)+_.x*j*x.y*(6*_.y*b.y+6*k.y*w.y)+k.x*j*x.y*(6*_.y*w.y+3*V)+z*(-2*_.y*k.y*w.y-Y*b.y-k.y*(2*_.y*w.y+V)-_.y*(2*_.y*b.y+2*k.y*w.y)),-m.x*g.x*v.y*x.x*x.y*w.y+m.x*g.y*v.x*x.x*x.y*w.y+6*m.x*g.y*v.y*x.x*w.x*x.y-6*m.y*g.x*v.x*x.x*x.y*w.y-m.y*g.x*v.y*x.x*w.x*x.y+m.y*g.y*v.x*x.x*w.x*x.y+g.x*g.y*v.x*v.y*x.x*w.y-g.x*g.y*v.x*v.y*w.x*x.y+g.x*_.x*v.y*x.x*x.y*w.y+g.x*_.y*v.y*x.x*w.x*x.y+g.x*k.x*v.y*x.x*k.y*x.y-_.x*g.y*v.x*x.x*x.y*w.y-6*_.x*g.y*v.y*x.x*w.x*x.y-g.y*v.x*_.y*x.x*w.x*x.y-g.y*v.x*k.x*x.x*k.y*x.y-6*m.x*_.x*w.x*U-2*m.x*D*x.x*w.x+2*_.x*D*x.x*w.x+2*m.y*O*x.y*w.y-6*m.x*m.y*x.x*w.x*B+3*m.x*g.x*v.x*B*w.y-2*m.x*g.x*v.y*w.x*B-4*m.x*g.y*v.x*w.x*B+3*m.y*g.x*v.x*w.x*B+6*m.x*m.y*j*x.y*w.y+6*m.x*_.x*x.x*B*w.y-3*m.x*g.y*v.y*j*w.y+2*m.x*v.x*L*x.x*w.y+2*m.x*v.x*L*w.x*x.y+6*m.x*_.y*x.x*w.x*B+6*m.x*k.x*x.x*k.y*B+4*m.y*g.x*v.y*j*w.y+6*m.y*_.x*x.x*w.x*B+2*m.y*g.y*v.x*j*w.y-3*m.y*g.y*v.y*j*w.x+2*m.y*v.x*L*x.x*w.x-3*g.x*_.x*v.x*B*w.y+2*g.x*_.x*v.y*w.x*B+g.x*g.y*L*x.x*w.x-3*g.x*v.x*_.y*w.x*B-3*g.x*v.x*k.x*k.y*B+4*_.x*g.y*v.x*w.x*B-2*m.x*S*v.y*x.y*w.y-6*m.y*_.x*j*x.y*w.y-6*m.y*_.y*j*w.x*x.y-6*m.y*k.x*j*k.y*x.y-2*m.y*S*v.y*x.x*w.y-2*m.y*S*v.y*w.x*x.y-g.x*g.y*S*x.y*w.y-2*g.x*R*x.x*w.x*x.y+3*_.x*g.y*v.y*j*w.y-2*_.x*v.x*L*x.x*w.y-2*_.x*v.x*L*w.x*x.y-6*_.x*_.y*x.x*w.x*B-6*_.x*k.x*x.x*k.y*B+3*g.y*_.y*v.y*j*w.x+3*g.y*k.x*v.y*j*k.y-2*v.x*_.y*L*x.x*w.x-2*v.x*k.x*L*x.x*k.y-R*v.x*v.y*x.x*w.x+2*_.x*S*v.y*x.y*w.y-3*g.y*G*v.y*x.x*x.y+6*_.y*k.x*j*k.y*x.y+2*A*g.y*x.x*x.y*w.y+A*v.x*v.y*x.y*w.y+2*S*_.y*v.y*w.x*x.y+2*S*k.x*v.y*k.y*x.y-3*m.x*G*U+3*_.x*G*U+3*M*w.x*U-3*T*z*w.y+3*q*w.x*U+G*D*x.x+C*j*w.x-N*B*w.y+3*m.y*G*x.x*B-g.x*R*j*w.y+g.x*G*v.y*B+2*g.y*v.x*G*B+A*g.y*w.x*B-v.x*G*L*x.y-3*_.y*G*x.x*B-3*M*x.x*B*w.y+3*T*j*w.x*x.y-A*L*x.x*w.y+R*S*w.x*x.y-3*q*x.x*B*w.y+3*Y*j*w.x*x.y+S*v.y*x.x*(2*_.y*w.y+V)+g.x*v.x*x.x*x.y*(6*_.y*w.y+3*V)+O*x.y*(-2*_.y*w.y-V)+m.y*z*(6*_.y*w.y+3*V)+g.y*v.x*j*(-2*_.y*w.y-V)+g.x*v.y*j*(-4*_.y*w.y-2*V)+m.x*j*x.y*(-6*_.y*w.y-3*V)+_.x*j*x.y*(6*_.y*w.y+3*V)+z*(-2*_.y*V-Y*w.y-_.y*(2*_.y*w.y+V)),-m.x*g.x*v.y*x.x*k.y*x.y+m.x*g.y*v.x*x.x*k.y*x.y+6*m.x*g.y*k.x*v.y*x.x*x.y-6*m.y*g.x*v.x*x.x*k.y*x.y-m.y*g.x*k.x*v.y*x.x*x.y+m.y*g.y*v.x*k.x*x.x*x.y-g.x*g.y*v.x*k.x*v.y*x.y+g.x*g.y*v.x*v.y*x.x*k.y+g.x*_.x*v.y*x.x*k.y*x.y+6*g.x*v.x*_.y*x.x*k.y*x.y+g.x*_.y*k.x*v.y*x.x*x.y-_.x*g.y*v.x*x.x*k.y*x.y-6*_.x*g.y*k.x*v.y*x.x*x.y-g.y*v.x*_.y*k.x*x.x*x.y-6*m.x*_.x*k.x*U-2*m.x*k.x*D*x.x+6*m.y*_.y*z*k.y+2*_.x*k.x*D*x.x+2*m.y*O*k.y*x.y-2*O*_.y*k.y*x.y-6*m.x*m.y*k.x*x.x*B+3*m.x*g.x*v.x*k.y*B-2*m.x*g.x*k.x*v.y*B-4*m.x*g.y*v.x*k.x*B+3*m.y*g.x*v.x*k.x*B+6*m.x*m.y*j*k.y*x.y+6*m.x*_.x*x.x*k.y*B-3*m.x*g.y*v.y*j*k.y+2*m.x*v.x*k.x*L*x.y+2*m.x*v.x*L*x.x*k.y+6*m.x*_.y*k.x*x.x*B+4*m.y*g.x*v.y*j*k.y+6*m.y*_.x*k.x*x.x*B+2*m.y*g.y*v.x*j*k.y-3*m.y*g.y*k.x*v.y*j+2*m.y*v.x*k.x*L*x.x-3*g.x*_.x*v.x*k.y*B+2*g.x*_.x*k.x*v.y*B+g.x*g.y*k.x*L*x.x-3*g.x*v.x*_.y*k.x*B+4*_.x*g.y*v.x*k.x*B-6*m.x*_.y*j*k.y*x.y-2*m.x*S*v.y*k.y*x.y-6*m.y*_.x*j*k.y*x.y-6*m.y*_.y*k.x*j*x.y-2*m.y*S*k.x*v.y*x.y-2*m.y*S*v.y*x.x*k.y-g.x*g.y*S*k.y*x.y-4*g.x*_.y*v.y*j*k.y-2*g.x*R*k.x*x.x*x.y+3*_.x*g.y*v.y*j*k.y-2*_.x*v.x*k.x*L*x.y-2*_.x*v.x*L*x.x*k.y-6*_.x*_.y*k.x*x.x*B-2*g.y*v.x*_.y*j*k.y+3*g.y*_.y*k.x*v.y*j-2*v.x*_.y*k.x*L*x.x-R*v.x*k.x*v.y*x.x+6*_.x*_.y*j*k.y*x.y+2*_.x*S*v.y*k.y*x.y+2*A*g.y*x.x*k.y*x.y+A*v.x*v.y*k.y*x.y+2*S*_.y*k.x*v.y*x.y+2*S*_.y*v.y*x.x*k.y+3*M*k.x*U-3*T*z*k.y+3*q*k.x*U+C*k.x*j-N*k.y*B-3*Y*z*k.y-g.x*R*j*k.y+A*g.y*k.x*B-3*M*x.x*k.y*B+3*T*k.x*j*x.y-A*L*x.x*k.y+R*S*k.x*x.y-3*q*x.x*k.y*B+3*Y*k.x*j*x.y,m.x*m.y*g.x*v.y*x.x*x.y-m.x*m.y*g.y*v.x*x.x*x.y+m.x*g.x*g.y*v.x*v.y*x.y-m.y*g.x*g.y*v.x*v.y*x.x-m.x*g.x*_.y*v.y*x.x*x.y+6*m.x*_.x*g.y*v.y*x.x*x.y+m.x*g.y*v.x*_.y*x.x*x.y-m.y*g.x*_.x*v.y*x.x*x.y-6*m.y*g.x*v.x*_.y*x.x*x.y+m.y*_.x*g.y*v.x*x.x*x.y-g.x*_.x*g.y*v.x*v.y*x.y+g.x*g.y*v.x*_.y*v.y*x.x+g.x*_.x*_.y*v.y*x.x*x.y-_.x*g.y*v.x*_.y*x.x*x.y-2*m.x*_.x*D*x.x+2*m.y*O*_.y*x.y-3*m.x*m.y*g.x*v.x*B-6*m.x*m.y*_.x*x.x*B+3*m.x*m.y*g.y*v.y*j-2*m.x*m.y*v.x*L*x.x-2*m.x*g.x*_.x*v.y*B-m.x*g.x*g.y*L*x.x+3*m.x*g.x*v.x*_.y*B-4*m.x*_.x*g.y*v.x*B+3*m.y*g.x*_.x*v.x*B+6*m.x*m.y*_.y*j*x.y+2*m.x*m.y*S*v.y*x.y+2*m.x*g.x*R*x.x*x.y+2*m.x*_.x*v.x*L*x.y+6*m.x*_.x*_.y*x.x*B-3*m.x*g.y*_.y*v.y*j+2*m.x*v.x*_.y*L*x.x+m.x*R*v.x*v.y*x.x+m.y*g.x*g.y*S*x.y+4*m.y*g.x*_.y*v.y*j-3*m.y*_.x*g.y*v.y*j+2*m.y*_.x*v.x*L*x.x+2*m.y*g.y*v.x*_.y*j+g.x*_.x*g.y*L*x.x-3*g.x*_.x*v.x*_.y*B-2*m.x*S*_.y*v.y*x.y-6*m.y*_.x*_.y*j*x.y-2*m.y*_.x*S*v.y*x.y-2*m.y*A*g.y*x.x*x.y-m.y*A*v.x*v.y*x.y-2*m.y*S*_.y*v.y*x.x-2*g.x*_.x*R*x.x*x.y-g.x*g.y*S*_.y*x.y+3*_.x*g.y*_.y*v.y*j-2*_.x*v.x*_.y*L*x.x-_.x*R*v.x*v.y*x.x+3*T*g.x*v.x*x.x*x.y+3*g.x*v.x*Y*x.x*x.y+2*_.x*S*_.y*v.y*x.y-3*M*g.y*v.y*x.x*x.y+2*A*g.y*_.y*x.x*x.y+A*v.x*_.y*v.y*x.y-3*q*g.y*v.y*x.x*x.y-P*U+I*z+X*U-H*z-3*m.x*q*U-m.x*C*j+3*M*_.x*U+m.y*N*B+3*m.y*Y*z+_.x*C*j+M*D*x.x-3*T*_.y*z-T*O*x.y+q*D*x.x-N*_.y*B-O*Y*x.y-m.x*A*g.y*B+m.y*g.x*R*j-3*m.x*T*j*x.y-m.x*R*S*x.y+m.y*A*L*x.x-g.x*R*_.y*j+3*M*m.y*x.x*B+M*g.x*v.y*B+2*M*g.y*v.x*B-2*T*g.x*v.y*j-T*g.y*v.x*j+A*_.x*g.y*B-3*m.x*Y*j*x.y+3*m.y*q*x.x*B+g.x*q*v.y*B-2*g.x*Y*v.y*j+_.x*R*S*x.y-g.y*v.x*Y*j-M*v.x*L*x.y-3*M*_.y*x.x*B+3*T*_.x*j*x.y+T*S*v.y*x.x-A*_.y*L*x.x+2*q*g.y*v.x*B+3*_.x*Y*j*x.y-q*v.x*L*x.y-3*q*_.y*x.x*B+S*Y*v.y*x.x),nt=et.getRootsInInterval(0,1);r.Utils.removeMultipleRootsIn01(nt);for(var it=0;it<nt.length;it++){var ot=nt[it],rt=new i(x.x,v.x,g.x,m.x-_.x-ot*k.x-ot*ot*w.x-ot*ot*ot*b.x).getRoots(),at=new i(x.y,v.y,g.y,m.y-_.y-ot*k.y-ot*ot*w.y-ot*ot*ot*b.y).getRoots();if(rt.length>0&&at.length>0){t:for(var st=0;st<rt.length;st++){var lt=rt[st];if(0<=lt&&lt<=1)for(var ht=0;ht<at.length;ht++)if(Math.abs(lt-at[ht])<1e-4){var ct=b.multiply(ot*ot*ot).add(w.multiply(ot*ot).add(k.multiply(ot).add(_)));E.points.push(new t(ct.x,ct.y));break t}}}}return E},r.intersectBezier3Ellipse=function(n,o,a,s,l,h,c){var y,u,p,d,f,x,v,g,m=new r;y=n.multiply(-1),u=o.multiply(3),p=a.multiply(-3),d=y.add(u.add(p.add(s))),f=new e(d.x,d.y),y=n.multiply(3),u=o.multiply(-6),p=a.multiply(3),d=y.add(u.add(p)),x=new e(d.x,d.y),y=n.multiply(-3),u=o.multiply(3),p=y.add(u),v=new e(p.x,p.y),g=new e(n.x,n.y);var b=h*h,w=c*c,k=new i(f.x*f.x*w+f.y*f.y*b,2*(f.x*x.x*w+f.y*x.y*b),2*(f.x*v.x*w+f.y*v.y*b)+x.x*x.x*w+x.y*x.y*b,2*f.x*w*(g.x-l.x)+2*f.y*b*(g.y-l.y)+2*(x.x*v.x*w+x.y*v.y*b),2*x.x*w*(g.x-l.x)+2*x.y*b*(g.y-l.y)+v.x*v.x*w+v.y*v.y*b,2*v.x*w*(g.x-l.x)+2*v.y*b*(g.y-l.y),g.x*g.x*w-2*g.y*l.y*b-2*g.x*l.x*w+g.y*g.y*b+l.x*l.x*w+l.y*l.y*b-b*w),_=k.getRootsInInterval(0,1);r.Utils.removeMultipleRootsIn01(_);for(var E=0;E<_.length;E++){var M=_[E],P=f.multiply(M*M*M).add(x.multiply(M*M).add(v.multiply(M).add(g)));m.points.push(new t(P.x,P.y))}return m},r.intersectBezier3Line=function(t,n,o,a,s,l){var h,c,y,u,p,d,f,x,v,g,m=s.min(l),b=s.max(l),w=new r;h=t.multiply(-1),c=n.multiply(3),y=o.multiply(-3),u=h.add(c.add(y.add(a))),p=new e(u.x,u.y),h=t.multiply(3),c=n.multiply(-6),y=o.multiply(3),u=h.add(c.add(y)),d=new e(u.x,u.y),h=t.multiply(-3),c=n.multiply(3),y=h.add(c),f=new e(y.x,y.y),x=new e(t.x,t.y),g=new e(s.y-l.y,l.x-s.x),v=s.x*l.y-l.x*s.y,roots=new i(g.dot(p),g.dot(d),g.dot(f),g.dot(x)+v).getRoots();for(var k=0;k<roots.length;k++){var _=roots[k];if(0<=_&&_<=1){var E=t.lerp(n,_),M=n.lerp(o,_),P=o.lerp(a,_),T=E.lerp(M,_),I=M.lerp(P,_),A=T.lerp(I,_);s.x==l.x?m.y<=A.y&&A.y<=b.y&&w.appendPoint(A):s.y==l.y?m.x<=A.x&&A.x<=b.x&&w.appendPoint(A):m.x<=A.x&&A.x<=b.x&&m.y<=A.y&&A.y<=b.y&&w.appendPoint(A)}}return w},r.intersectEllipseEllipse=function(e,n,o,a,s,l){var h,c=[o*o,0,n*n,-2*o*o*e.x,-2*n*n*e.y,o*o*e.x*e.x+n*n*e.y*e.y-n*n*o*o],y=[l*l,0,s*s,-2*l*l*a.x,-2*s*s*a.y,l*l*a.x*a.x+s*s*a.y*a.y-s*s*l*l],u=r.Utils.bezout(c,y),p=u.getRoots(),d=.001*(c[0]*c[0]+2*c[1]*c[1]+c[2]*c[2]),f=.001*(y[0]*y[0]+2*y[1]*y[1]+y[2]*y[2]),x=new r,v=function(t,e,n){return Math.max(e,Math.min(n,t))};for(h=0;h<p.length;h++)p[h]=v(p[h],e.y-o,e.y+o),p[h]=v(p[h],a.y-l,a.y+l);p.sort(function(t,e){return t-e});for(var g=[],m=0;m<p.length;m++){var b=new i(c[0],c[3]+p[m]*c[1],c[5]+p[m]*(c[4]+p[m]*c[2]));Math.abs(b.coefs[0])<10*1e-15*Math.abs(b.coefs[2])&&(b.coefs[0]=0);var w=b.getRoots();g.push(0);for(var k=0;k<w.length;k++){var _=(c[0]*w[k]+c[1]*p[m]+c[3])*w[k]+(c[2]*p[m]+c[4])*p[m]+c[5];Math.abs(_)<d&&(_=(y[0]*w[k]+y[1]*p[m]+y[3])*w[k]+(y[2]*p[m]+y[4])*p[m]+y[5],Math.abs(_)<f&&(x.appendPoint(new t(w[k],p[m])),g[m]+=1))}}if(x.points.length<=0)return x;var E=x.points;if(8==E.length)E=E.splice(0,6),E.splice(2,2);else if(7==E.length)E=E.splice(0,6),E.splice(2,2),E.splice(g.indexOf(1),1);else if(6==E.length)E.splice(2,2),g.indexOf(0)>-1?E[0].distanceFrom(E[1])<E[2].distanceFrom(E[3])?E.splice(0,1):E.splice(2,1):g[0]==g[3]&&E.splice(1,2);else if(4==E.length)(2==p.length||4==p.length&&(2==g[0]&&2==g[1]||2==g[2]&&2==g[3]))&&E.splice(2,2);else if((3==E.length||5==E.length)&&(h=g.indexOf(2))>-1){3==E.length&&(h%=2);var M,P,T,I=h+(h%2?-1:2);M=E[h].distanceFrom(E[h+1]),P=E[h].distanceFrom(E[I]),T=E[h+1].distanceFrom(E[I]),M<P&&M<T?E.splice(h,1):E.splice(I,1)}var A=u.zeroErrorEstimate();for(A*=100*Math.SQRT2,h=0;h<E.length-1;)E[h].distanceFrom(E[h+1])<A?E.splice(h+1,1):h++;return x.points=E,x},r.intersectEllipseLine=function(t,n,i,o,a){var s,l=new e(o.x,o.y),h=e.fromPoints(o,a),c=new e(t.x,t.y),y=l.subtract(c),u=new e(h.x/(n*n),h.y/(i*i)),p=new e(y.x/(n*n),y.y/(i*i)),d=h.dot(u),f=h.dot(p),t=y.dot(p)-1,x=f*f-d*t,v=10*Math.max(Math.abs(d),Math.abs(f),Math.abs(t))*1e-15;if(Math.abs(x)<v&&(x=0),x<0)s=new r("Outside");else if(x>0){var g=Math.sqrt(x),m=(-f-g)/d,b=(-f+g)/d;b=b>1?b-1e-15:b<0?b+1e-15:b,m=m>1?m-1e-15:m<0?m+1e-15:m,(m<0||1<m)&&(b<0||1<b)?s=new r(m<0&&b<0||m>1&&b>1?"Outside":"Inside"):(s=new r,0<=m&&m<=1&&s.appendPoint(o.lerp(a,m)),0<=b&&b<=1&&s.appendPoint(o.lerp(a,b)))}else{var w=-f/d;0<=w&&w<=1?(s=new r,s.appendPoint(o.lerp(a,w))):s=new r("Outside")}return s},r.intersectLineLine=function(e,n,i,o){var a,s=(o.x-i.x)*(e.y-i.y)-(o.y-i.y)*(e.x-i.x),l=(n.x-e.x)*(e.y-i.y)-(n.y-e.y)*(e.x-i.x),h=(o.y-i.y)*(n.x-e.x)-(o.x-i.x)*(n.y-e.y);if(0!==h){var c=s/h,y=l/h;0<=c&&c<=1&&0<=y&&y<=1?(a=new r,a.points.push(new t(e.x+c*(n.x-e.x),e.y+c*(n.y-e.y)))):a=new r}else a=new r(0===s||0===l?"Coincident":"Parallel");return a},r.intersectRayRay=function(e,n,i,o){var a,s=(o.x-i.x)*(e.y-i.y)-(o.y-i.y)*(e.x-i.x),l=(n.x-e.x)*(e.y-i.y)-(n.y-e.y)*(e.x-i.x),h=(o.y-i.y)*(n.x-e.x)-(o.x-i.x)*(n.y-e.y);if(0!==h){var c=s/h;a=new r,a.points.push(new t(e.x+c*(n.x-e.x),e.y+c*(n.y-e.y)))}else a=new r(0===s||0===l?"Coincident":"Parallel");return a},r.Utils={},r.Utils.bezout=function(t,e){var n=t[0]*e[1]-e[0]*t[1],o=t[0]*e[2]-e[0]*t[2],r=t[0]*e[3]-e[0]*t[3],a=t[0]*e[4]-e[0]*t[4],s=t[0]*e[5]-e[0]*t[5],l=t[1]*e[2]-e[1]*t[2],h=t[1]*e[4]-e[1]*t[4],c=t[1]*e[5]-e[1]*t[5],y=t[2]*e[3]-e[2]*t[3],u=t[3]*e[4]-e[3]*t[4],p=t[3]*e[5]-e[3]*t[5],d=c+u,f=h-y;return new i(n*l-o*o,n*f+r*l-2*o*a,n*d+r*f-a*a-2*o*s,n*p+r*d-2*a*s,r*p-s*s)},r.Utils.removeMultipleRootsIn01=function(t){t.sort(function(t,e){return t-e});for(var e=1;e<t.length;)Math.abs(t[e]-t[e-1])<1e-15?t.splice(e,1):e++},r.Utils.removePointsNotInArc=function(t,i,o,r,a,s,l,h){if(0===t.points.length)return t;if(h&&!h.isIdentity())var c=h.inverse();var y=[],u=new e(1,0),p=2*Math.PI,d=l<0,f=Math.abs(l)>Math.PI,x=(new n).scaleNonUniform(1,r/o).rotate(s),v=(new n).scaleNonUniform(1,r/o).rotate(s+l);s=(u.angleBetween(u.transform(x))+p)%p,l=u.transform(x).angleBetween(u.transform(v)),l=(f?p-Math.abs(l):Math.abs(l))*(d?-1:1);for(var g,m,b=(new n).rotate(a).multiply(x),w=0;w<t.points.length;w++)g=t.points[w],m=u.transform(b).angleBetween(e.fromPoints(i,c?g.transform(c):g)),l>=0?(m=(m+2*p)%p)<=l&&y.push(g):(m=(m-2*p)%p)>=l&&y.push(g);return t.points=y,t},r.Utils.removeClosePoints=function(t,e){if(0!==t.length&&0!==e.length){var n=function(t,e){return t<e.x&&(t=e.x),t<e.y&&(t=e.y),t},i=t.reduce(n,0);i=e.reduce(n,i);for(var o,r=100*i*1e-15*Math.SQRT2,a=0;a<t.length;){for(o=0;o<e.length;o++)if(t[a].distanceFrom(e[o])<=r){t.splice(a,1);break}o==e.length&&a++}}},r})}).call(e,n(65)(t))},209:function(t,e,n){"use strict";var i;!function(o,r,a){function s(t,e,n){if(t.addEventListener)return void t.addEventListener(e,n,!1);t.attachEvent("on"+e,n)}function l(t){if("keypress"==t.type){var e=String.fromCharCode(t.which);return t.shiftKey||(e=e.toLowerCase()),e}return w[t.which]?w[t.which]:k[t.which]?k[t.which]:String.fromCharCode(t.which).toLowerCase()}function h(t,e){return t.sort().join(",")===e.sort().join(",")}function c(t){var e=[];return t.shiftKey&&e.push("shift"),t.altKey&&e.push("alt"),t.ctrlKey&&e.push("ctrl"),t.metaKey&&e.push("meta"),e}function y(t){if(t.preventDefault)return void t.preventDefault();t.returnValue=!1}function u(t){if(t.stopPropagation)return void t.stopPropagation();t.cancelBubble=!0}function p(t){return"shift"==t||"ctrl"==t||"alt"==t||"meta"==t}function d(){if(!b){b={};for(var t in w)t>95&&t<112||w.hasOwnProperty(t)&&(b[w[t]]=t)}return b}function f(t,e,n){return n||(n=d()[t]?"keydown":"keypress"),"keypress"==n&&e.length&&(n="keydown"),n}function x(t){return"+"===t?["+"]:(t=t.replace(/\+{2}/g,"+plus"),t.split("+"))}function v(t,e){var n,i,o,r=[];for(n=x(t),o=0;o<n.length;++o)i=n[o],E[i]&&(i=E[i]),e&&"keypress"!=e&&_[i]&&(i=_[i],r.push("shift")),p(i)&&r.push(i);return e=f(i,r,e),{key:i,modifiers:r,action:e}}function g(t,e){return null!==t&&t!==r&&(t===e||g(t.parentNode,e))}function m(t){function e(t){t=t||{};var e,n=!1;for(e in b)t[e]?n=!0:b[e]=0;n||(_=!1)}function n(t,e,n,i,o,r){var a,s,l=[],c=n.type;if(!x._callbacks[t])return[];for("keyup"==c&&p(t)&&(e=[t]),a=0;a<x._callbacks[t].length;++a)if(s=x._callbacks[t][a],(i||!s.seq||b[s.seq]==s.level)&&c==s.action&&("keypress"==c&&!n.metaKey&&!n.ctrlKey||h(e,s.modifiers))){var y=!i&&s.combo==o,u=i&&s.seq==i&&s.level==r;(y||u)&&x._callbacks[t].splice(a,1),l.push(s)}return l}function i(t,e,n,i){x.stopCallback(e,e.target||e.srcElement,n,i)||!1===t(e,n)&&(y(e),u(e))}function o(t){"number"!=typeof t.which&&(t.which=t.keyCode);var e=l(t);if(e)return"keyup"==t.type&&w===e?void(w=!1):void x.handleKey(e,c(t),t)}function a(){clearTimeout(g),g=setTimeout(e,1e3)}function d(t,n,o,r){function s(n){i(o,n,t),"keyup"!==r&&(w=l(n)),setTimeout(e,10)}b[t]=0;for(var h=0;h<n.length;++h){var c=h+1===n.length,y=c?s:function(e){return function(){_=e,++b[t],a()}}(r||v(n[h+1]).action);f(n[h],y,r,t,h)}}function f(t,e,i,o,r){x._directMap[t+":"+i]=e,t=t.replace(/\s+/g," ");var a,s=t.split(" ");if(s.length>1)return void d(t,s,e,i);a=v(t,i),x._callbacks[a.key]=x._callbacks[a.key]||[],n(a.key,a.modifiers,{type:a.action},o,t,r),x._callbacks[a.key][o?"unshift":"push"]({callback:e,modifiers:a.modifiers,action:a.action,seq:o,level:r,combo:t})}var x=this;if(t=t||r,!(x instanceof m))return new m(t);x.target=t,x._callbacks={},x._directMap={};var g,b={},w=!1,k=!1,_=!1;x._handleKey=function(t,o,r){var a,s=n(t,o,r),l={},h=0,c=!1;for(a=0;a<s.length;++a)s[a].seq&&(h=Math.max(h,s[a].level));for(a=0;a<s.length;++a)if(s[a].seq){if(s[a].level!=h)continue;c=!0,l[s[a].seq]=1,i(s[a].callback,r,s[a].combo,s[a].seq)}else c||i(s[a].callback,r,s[a].combo);var y="keypress"==r.type&&k;r.type!=_||p(t)||y||e(l),k=c&&"keydown"==r.type},x._bindMultiple=function(t,e,n){for(var i=0;i<t.length;++i)f(t[i],e,n)},s(t,"keypress",o),s(t,"keydown",o),s(t,"keyup",o)}for(var b,w={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},k={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},_={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},E={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},M=1;M<20;++M)w[111+M]="f"+M;for(M=0;M<=9;++M)w[M+96]=M;m.prototype.bind=function(t,e,n){var i=this;return t=t instanceof Array?t:[t],i._bindMultiple.call(i,t,e,n),i},m.prototype.unbind=function(t,e){var n=this;return n.bind.call(n,t,function(){},e)},m.prototype.trigger=function(t,e){var n=this;return n._directMap[t+":"+e]&&n._directMap[t+":"+e]({},t),n},m.prototype.reset=function(){var t=this;return t._callbacks={},t._directMap={},t},m.prototype.stopCallback=function(t,e){var n=this;return!((" "+e.className+" ").indexOf(" mousetrap ")>-1)&&(!g(e,n.target)&&("INPUT"==e.tagName||"SELECT"==e.tagName||"TEXTAREA"==e.tagName||e.isContentEditable))},m.prototype.handleKey=function(){var t=this;return t._handleKey.apply(t,arguments)},m.init=function(){var t=m(r);for(var e in t)"_"!==e.charAt(0)&&(m[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e))},m.init(),o.Mousetrap=m,void 0!==t&&t.exports&&(t.exports=m),void 0!==(i=function(){return m}.call(e,n,e,t))&&(t.exports=i)}(window,document)},210:function(t,e,n){"use strict";t.exports=n(211).default},211:function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function t(t,e){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){o=!0,r=t}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),h=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),c=n(59),y=o(c),u=n(5),p=o(u),d=n(32),f=i(d),x=n(212),v=o(x),g=n(218),m=i(g),b=n(223),w=o(b),k=n(209),_=o(k);n(617);var E={keyId:"id",nodeFields:[],linkFields:[],linkStartOffset:5.5,linkEndOffset:7,linkMirrorGap:12,linkTextOffset:12,clearOnePxLink:!0,guideThreshold:10,initialized:!1,historyMaxStates:1/0,resizeHandleSize:10,resizeHandleExpandSize:5,areaMinSize:10,inputClass:null,svgClass:null,baseHref:null,linkThroughTextEnabled:!1,interactEnabled:!0,shortcutsEnabled:!0,dragNodeEnabled:!0,selectLinkEnabled:!0,hoverLinkEnabled:!0,dragNoteEnabled:!0,dragNoteArrowEnabled:!0,dragAreaEnabled:!0,resizeAreaEnabled:!0,guideLineEnabled:!0,centerEnabled:!0,wheelZoomEnabled:!0,autoScaleToFitCanvas:!1,hoverEnabled:!0,dragCanvasEnabled:!0,capacityEnabled:!0,capacityRadius:32,capacityVisibility:!1,labelEnabled:!0,labelVisibility:!0,linkTextRender:null,scaleRange:[.4,3],size:[600,400],linkStrength:1,alpha:1,alphaMin:.1,alphaDecay:1-Math.pow(.001,1/300),linkDistance:200,charge:-600,theta:.8},M="initializing",P="force-ticking",T="idle",I=m.default.DEFAULT_TEXT_POSITION,A=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.nodes,i=void 0===n?[]:n,o=t.links,s=void 0===o?[]:o,l=t.areas,h=void 0===l?[]:l,c=t.notes,y=void 0===c?[]:c,u=t.fixed,d=void 0!==u&&u,x=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,e);var g=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));if(g.nodes=i,g.links=s,g.areas=h,g.notes=y,g.options=p.default.defaults(x,E),g.history=new v.default({maxStates:x.historyMaxStates}),g.keyId=x.keyId,g.nodeFields=x.nodeFields,g.linkFields=x.linkFields,g._window=f.select(window),g.state=M,g.uniqId=p.default.uniqueId("topo"),x.interactEnabled||p.default.forEach(["shortcutsEnabled","dragNodeEnabled","selectLinkEnabled","hoverLinkEnabled","dragNoteEnabled","dragNoteArrowEnabled","dragAreaEnabled","resizeAreaEnabled","guideLineEnabled"],function(t){x[t]=!1}),x.initialized||g.initLinks(),p.default.forEach(h,function(t){t.areaId=p.default.uniqueId("area")}),p.default.forEach(y,function(t){t.noteId=p.default.uniqueId("note")}),g.fixed=d,!d){var m=x.size,b=x.linkStrength,w=x.alpha,k=x.alphaMin,_=x.linkDistance,I=x.charge,A=x.theta,N=x.keyId;g._force=f.forceSimulation().alpha(w).alphaMin(k).force("link",f.forceLink().id(function(t){return t[N]}).strength(b).distance(_)).force("charge",f.forceManyBody().strength(I).theta(A).distanceMin(10).distanceMax(200)).force("center",f.forceCenter(m[0]/2,m[1]/2)).on("end",function(){return g._forceEnd()})}g.elements={},g.elements.scaleLevel=1;var R=g.elements.root=f.select(x.appendTo),C=getComputedStyle(R.node());"static"===C.position&&R.style("position","relative");var S=g.elements.svg=R.append("svg").attr("class","apps-topology");d?(S.classed("fixed",!0),g.state=T):g.state=P,x.svgClass&&S.classed(x.svgClass,!0),g.setSize(x.size),g._initDefs();var O=g.elements.canvasWrapper=S.append("g").attr("class","canvas-wrapper"),L=(g.elements.canvasRect=O.append("rect").attr("width",g.options.size[0]).attr("height",g.options.size[1]).attr("class","canvas-rect").style("fill","none").style("pointer-events","all"),g.elements.screenCanvas=O.append("g").attr("class","screen-canvas"));x.wheelZoomEnabled&&g._initCanvasWheelZoom();var D=g.elements.html=R.append("div").attr("class","apps-topology-html").style("top",C.paddingTop).style("right",C.paddingRight).style("bottom",C.paddingBottom).style("left",C.paddingLeft),j=g.elements.htmlInput=D.append("textarea").attr("class","input-text");x.inputClass&&j.classed(x.inputClass,!0),d&&x.centerEnabled&&g.centerCanvas(),x.autoScaleToFitCanvas&&g.scaleToFitCanvas(),g.elements.area=L.append("g").attr("class","area-list").selectAll(".area"),g.elements.link=L.append("g").attr("class","link-list").selectAll(".link"),g.elements.node=L.append("g").attr("class","node-list").selectAll(".node"),g.elements.note=L.append("g").attr("class","note-list").selectAll(".note"),x.guideLineEnabled&&(g.elements.guide=L.append("g").attr("class","guide-list").selectAll(".guide"));var z=g.elements.userCanvas=L.append("g").attr("class","user-canvas");return g.elements.linkLine=z.append("line").attr("marker-end",g._getRelativeUrl("#link-arrow")),g.elements.selectRect=z.append("rect"),g._initDrags(),g.reflow(),x.shortcutsEnabled&&g.enableShortcuts(),setTimeout(function(){return g.emit("stateChange",g.state)}),g}return s(e,t),h(e,[{key:"_initDefs",value:function(){var t=this.elements.defs=this.elements.svg.append("defs"),e={viewBox:"0 0 10 10",refX:7.5,refY:5,markerWidth:6,markerHeight:6,orient:"auto"};p.default.forEach([{id:"link-arrow",class:"marker"},{id:"link-arrow-hover",class:"marker hover"},{id:"link-arrow-active",class:"marker active"},{id:"link-arrow-success",class:"marker success"},{id:"link-arrow-warn",class:"marker warn"},{id:"link-arrow-danger",class:"marker danger"},{id:"link-arrow-one-on-one",class:"marker one-on-one"},{id:"link-arrow-one-on-multiple",class:"marker one-on-multiple"}],function(n){var i=t.append("marker");p.default.forEach(e,function(t,e){i.attr(e,t)}),p.default.forEach(n,function(t,e){i.attr(e,t)}),i.append("path").attr("d","M 0 0 L 10 5 L 0 10 z")});var n=t.append("filter").attr("id","drop-shadow").attr("x","-50%").attr("y","-50%").attr("width","200%").attr("height","200%");n.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",2).attr("result","blur"),n.append("feOffset").attr("in","blur").attr("dx",0).attr("dy",1).attr("result","offsetBlur"),n.append("feFlood").attr("in","offsetBlur").attr("flood-color","#878b8f").attr("result","offsetColor"),n.append("feComposite").attr("in","offsetColor").attr("in2","offsetBlur").attr("operator","in").attr("result","offsetBlur");var i=n.append("feMerge");i.append("feMergeNode").attr("in","offsetBlur"),i.append("feMergeNode").attr("in","SourceGraphic")}},{key:"_initCanvasDrag",value:function(){var t=this,e=this.canvasOffset={x:0,y:0};if(this.options.dragCanvasEnabled){var n=this.elements,i=n.svg,o=n.screenCanvas,r=void 0,a=void 0,s=void 0,l=void 0;this.dragCanvas=f.drag().on("start",function(){f.event.sourceEvent.stopPropagation(),i.classed("dragging-canvas",!0),r=e.x,a=e.y,s=l=0,t.state="dragging-canvas",t.emit("stateChange",t.state)}).on("drag",function(){s+=f.event.dx,l+=f.event.dy,e.x=r+s,e.y=a+l;var t=o.attr("transform")||"",n=t.match(/(translate)(\(.+?\))/gi),i="translate("+e.x+","+e.y+")";n?o.attr("transform",t.replace(/(translate)(\(.+?\))/gi,i)):o.attr("transform",t+" "+i)}).on("end",function(){i.classed("dragging-canvas",!1),t.state=T,t.emit("stateChange",t.state)}),i.call(this.dragCanvas)}}},{key:"_initCanvasWheelZoom",value:function(){var t=this,e=this.elements,n=e.svg,i=e.canvasWrapper,o=e.screenCanvas,r=this.options.scaleRange;this.elements.transform=f.zoomTransform(i.node()),this.zoomCanvas=f.zoom().scaleExtent(r).on("start",function(){n.classed("zooming-canvas",!0),t.state="zoom-canvas-start",t.emit("stateChange",t.state)}).on("start.mousedown",function(){n.classed("dragging-canvas",!0)}).on("zoom",function(){var e=t.elements.transform=f.zoomTransform(i.node()),n=t.elements.scaleLevel=e.k;n<.8?t._setLabelVisibility(!1):t._setLabelVisibility(!0),n<.55?t._setNoteVisibility(!1):t._setNoteVisibility(!0),o.attr("transform","translate("+e.x+","+e.y+")scale("+e.k+")"),t.state="zooming-canvas",t.emit("stateChange",t.state)}).on("end",function(){n.classed("zooming-canvas dragging-canvas",!1),t.state="zoom-canvas-end",t.emit("stateChange",t.state),t.state=T,t.emit("stateChange",t.state)}),i.call(this.zoomCanvas).on("dblclick.zoom",function(){t.state="dblclick",t.emit("stateChange",t.state)})}},{key:"getHovedNode",value:function(){return!(!f.event||!f.event.target)&&(this.getClosestNode(f.event.target)||!1)}},{key:"getScaleRange",value:function(){return this.options.scaleRange}},{key:"getScaleLevel",value:function(){return this.elements.scaleLevel}},{key:"getCanvasTransform",value:function(){return this.elements.transform}},{key:"setCanvasScale",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;if(isNaN(t))throw new TypeError("scaleLevel should be a number.");var n=this.zoomCanvas;this.elements.canvasWrapper.transition().duration(e).call(n.scaleTo,t)}},{key:"setCanvasRectSize",value:function(t){var e=l(t,2),n=e[0],i=e[1],o=this.elements.canvasRect;o&&(n=n||o.attr("width"),i=i||o.attr("height"),o.attr("width",n).attr("height",i))}},{key:"_setLabelVisibility",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.elements.labelVisibility!==t){var e=this.elements.screenCanvas;this.elements.labelVisibility=t,e.selectAll("g.node-label").classed("hidden",!t)}}},{key:"_setNoteVisibility",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.elements.nodeTextVisibility!==t){var e=this.elements.screenCanvas;this.elements.nodeTextVisibility=t,e.selectAll("g.note text.note-text").classed("hidden",!t)}}},{key:"_initDrags",value:function(){var t=this,e=this.options,n=e.guideLineEnabled,i=e.guideThreshold,o=this.nodes;this.dragNode=f.drag().on("start",function(e){f.event.sourceEvent.stopPropagation(),t.elements.svg.classed("dragging-node",!0),e._beforeDragX=e.x,e._beforeDragY=e.y,e._dx=0,e._dy=0,t.setActive("node",e),t.state="drag-start",t.emit("stateChange",t.state),t.state="dragging-node-start",t.emit("stateChange",t.state)}).on("drag",function(e){if(e._dx+=f.event.dx,e._dy+=f.event.dy,e.x=e._beforeDragX+e._dx,e.y=e._beforeDragY+e._dy,n&&o.length>1){var r=t.getClosestGuides(e);r.vertical.diff<i&&(e.x+=r.vertical.value),r.horizontal.diff<i&&(e.y+=r.horizontal.value)}t.state="dragging-node",t.emit("stateChange",t.state),t._tick({node:e})}).on("end",function(e){t.elements.svg.classed("dragging-node",!1),n&&t.elements.guide.selectAll("line").classed("active",!1);var i={x:e._beforeDragX,y:e._beforeDragY},o={x:e.x,y:e.y};delete e._beforeDragX,delete e._beforeDragY,delete e._dx,delete e._dy,p.default.isEqual(i,o)||t._pushHistory("dragNode",{node:e,from:i,to:o}),t.state="drag-end",t.emit("stateChange",t.state),t.state=T,t.emit("stateChange",t.state)}),this.dragArea=f.drag().on("start",function(e){f.event.sourceEvent.stopPropagation(),t.elements.svg.classed("dragging-area",!0),e._beforeDragX=e.x,e._beforeDragY=e.y,t.setActive("area",e),t.state="drag-start",t.emit("stateChange",t.state),t.state="dragging-area-start",t.emit("stateChange",t.state)}).on("drag",function(e){e.x+=f.event.dx,e.y+=f.event.dy,t.state="dragging-area",t.emit("stateChange",t.state),t._tick({})}).on("end",function(e){t.elements.svg.classed("dragging-area",!1);var n={x:e._beforeDragX,y:e._beforeDragY},i={x:e.x,y:e.y};delete e._beforeDragX,delete e._beforeDragY,p.default.isEqual(n,i)||t._pushHistory("dragArea",{area:e,from:n,to:i}),t.state="drag-end",t.emit("stateChange",t.state),t.state=T,t.emit("stateChange",t.state)}),this.dragNote=f.drag().on("start",function(e){f.event.sourceEvent.stopPropagation(),t.elements.svg.classed("dragging-note",!0),e._beforeDragX=e.x,e._beforeDragY=e.y,t.setActive("note",e),t.state="drag-start",t.emit("stateChange",t.state),t.state="dragging-note-start",t.emit("stateChange",t.state)}).on("drag",function(e){e.x+=f.event.dx,e.y+=f.event.dy,t.state="dragging-note",t.emit("stateChange",t.state),t._tick({})}).on("end",function(e){t.elements.svg.classed("dragging-note",!1);var n={x:e._beforeDragX,y:e._beforeDragY},i={x:e.x,y:e.y};delete e._beforeDragX,delete e._beforeDragY,p.default.isEqual(n,i)||t._pushHistory("dragNote",{note:e,from:n,to:i}),t.state="drag-end",t.emit("stateChange",t.state),t.state=T,t.emit("stateChange",t.state)})}},{key:"centerCanvas",value:function(){if(this.options.centerEnabled){var t=this.options.size[0],e=this.options.size[1],n=p.default.map(this.nodes,"x").concat(p.default.map(this.areas,"x")).concat(p.default.map(this.notes,"x")),i=p.default.map(this.nodes,"y").concat(p.default.map(this.areas,"y")).concat(p.default.map(this.notes,"y")),o=p.default.min(n),r=p.default.max(n),a=p.default.min(i),s=p.default.max(i),l=0,h=0;l=o-(o+(t-r))/2,h=a-(a+(e-s))/2,this.nodes=p.default.map(this.nodes,function(t){return t.x-=l,t.y-=h,t}),this.areas=p.default.map(this.areas,function(t){return t.x-=l,t.y-=h,t}),this.notes=p.default.map(this.notes,function(t){return t.x-=l,t.y-=h,t})}}},{key:"scaleToFitCanvas",value:function(){if(this.options.autoScaleToFitCanvas){var t=p.default.map(this.nodes,"x").concat(p.default.map(this.areas,"x")).concat(p.default.map(this.notes,"x")),e=p.default.map(this.nodes,"y").concat(p.default.map(this.areas,"y")).concat(p.default.map(this.notes,"y")),n=p.default.min(t),i=p.default.max(t),o=p.default.min(e),r=p.default.max(e),a=i-n+150,s=r-o+100,l=this.options.size[0],h=this.options.size[1],c=a-l,y=s-h,u=1;(c>0||y>0)&&(u=c>y?l/a:h/s),this.setCanvasScale(u)}}},{key:"getMinWidth",value:function(){var t=p.default.map(this.nodes,"x").concat(p.default.map(this.areas,"x")).concat(p.default.map(this.notes,"x")),e=p.default.min(t);return p.default.max(t)-e}},{key:"getMinHeight",value:function(){var t=p.default.map(this.nodes,"y").concat(p.default.map(this.areas,"y")).concat(p.default.map(this.notes,"y")),e=p.default.min(t);return p.default.max(t)-e}},{key:"destroy",value:function(){this._window.on("."+this.uniqId,null),_.default.reset()}},{key:"enableShortcuts",value:function(){var t=this;_.default.bind("mod+z",function(){return t.undo(),!1}),_.default.bind("mod+shift+z",function(){return t.redo(),!1}),_.default.bind(["del","backspace"],function(){var e=!t._activeElem;return t.removeNode(),t.unlink(),t.removeArea(),t.removeNote(),e}),_.default.bind("esc",function(){return t.idle()})}},{key:"getData",value:function(){var t=this.keyId,e=p.default.concat(this.nodeFields,["x","y","shape","label","transform","textPosition",t]),n=this.linkFields,i=["x","y","width","height"],o=["x","y","content","arrowDirection"],r=p.default.map(this.nodes,function(t){return p.default.pick(t,e)});return p.default.forEach(r,function(t){t.shape=t.shape.shapeName}),{nodes:r,links:p.default.map(this.links,function(e){var i=p.default.pick(e,n);return i.source=e.source[t],i.target=e.target[t],i}),areas:p.default.map(this.areas,function(t){return p.default.pick(t,i)}),notes:p.default.map(this.notes,function(t){return p.default.pick(t,o)}),fixed:this.fixed}}},{key:"setSize",value:function(t){var e=l(t,2),n=e[0],i=e[1];this.elements.svg.attr("width",n).attr("height",i),this.setCanvasRectSize([n,i])}},{key:"reflow",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n&&!n.node||(this._reflowNodes(),this.options.guideLineEnabled&&this._reflowGuides()),(!n||n.link||n.node)&&this._reflowLinks(),n&&!n.area||this._reflowAreas(),n&&!n.note||this._reflowNotes(),e&&this.elements.node.order(),this._force?this._force.nodes(this.nodes).force("link").links(this.links):this._tick(n),setTimeout(function(){return t.emit("reflow")})}},{key:"_reflowNodes",value:function(){var t=this,e=this.keyId,n=this.elements.node.data(this.nodes,function(t){return t[e]});n.exit().remove();var i=n.enter().append("g").attr("class","node").attr("data-node-id",function(t){return t[e]});n=this.elements.node=i.merge(n);var o=this;i.each(function(t){var e=f.select(this);"string"==typeof t.shape&&(t.shape=new m[t.shape](t,o)),t.shape.renderTo(e)}),setTimeout(function(){return i.select(".shape-dot").attr("filter",t._getRelativeUrl("#drop-shadow"))}),i.on("click",function(){f.event.stopPropagation()});var r=this.options.hoverEnabled;i.on("mouseenter",function(t){o.emit("nodeMouseenter",t),o.state===T&&r&&(n.classed("hover-active",!1).classed("hover-inactive",!0),f.select(this).classed("hover-active",!0).classed("hover-inactive",!1),o.elements.link.each(function(e){var i=void 0;e.source===t?i=e.target:e.target===t&&(i=e.source),f.select(this).classed("hover-active-related",!!i).classed("hover-inactive",!i),i&&n.each(function(t){i===t&&(f.select(this).classed("hover-inactive",!1),f.select(this).classed("hover-active-related",!0))})}),o.elements.area.classed("hover-inactive",!0),o.elements.note.classed("hover-inactive",!0))}),i.on("mouseleave",function(e){t.emit("nodeMouseleave",e),o.state===T&&r&&(n.classed("hover-active",!1).classed("hover-inactive",!1).classed("hover-active-related",!1),o.elements.link.classed("hover-active-related",!1).classed("hover-inactive",!1),o.elements.area.classed("hover-inactive",!1),o.elements.note.classed("hover-inactive",!1))}),this._force||this.options.dragNodeEnabled&&i.call(this.dragNode)}},{key:"_reflowGuides",value:function(){var t=this.keyId,e=this.elements.guide.data(this.nodes,function(e){return e[t]});e.exit().remove();var n=e.enter().append("g").attr("class","guide");this.elements.guide=n.merge(e),p.default.forEach(["cx","left","right","cy","top","bottom"],function(t){n.append("line").attr("class","pos-"+t)})}},{key:"_reflowLinks",value:function(){var t=this,e=this.keyId,n=this.elements.link.data(this.links,function(t){return t.source[e]+"=>"+t.target[e]});n.exit().remove().each(function(t){t.mirror&&(delete t.mirror.mirror,delete t.mirror)});var i=n.enter().append("g").attr("class",function(t){return"link "+(t.linkClass||"")}).attr("data-link-id",function(t){return t.source[e]+"-"+t.target[e]});i.append("line").attr("class","link-bg"),i.append("line").attr("class","link-arrow").attr("marker-end",function(e){return t._getRelativeUrl("#link-arrow"+(e.linkClass?"-"+e.linkClass:""))}),this.options.linkTextRender?this.options.linkTextRender(i):i.append("text").attr("dy",4.5).attr("class","link-text").text(function(t){return t.source.name[0]+" --\x3e "+t.target.name[0]}),this.elements.link=i.merge(n);var o=this,r="";this.options.hoverLinkEnabled&&i.on("mouseenter",function(t,e,n){var i=f.select(this);i.classed("active")||(r=i.select(".link-arrow").attr("marker-end"),i.select(".link-arrow").attr("marker-end",o._getRelativeUrl("#link-arrow-hover")))}).on("mouseleave",function(){var t=f.select(this);t.classed("active")||t.select(".link-arrow").attr("marker-end",r)}),i.on("mousedown",function(){return f.event.preventDefault()}),this.options.selectLinkEnabled&&i.on("click",function(e){f.event.stopPropagation(),t.setActive("link",e)}),i.each(function(e){if(!e.mirror){var n=p.default.find(t.links,function(t){return t.source===e.target&&t.target===e.source});n&&(e.mirror=n,n.mirror=e)}})}},{key:"showLinkText",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.elements.svg;if(e.classed("show-link-text",t),!t){var n=e.selectAll("g.link");n.selectAll("text.link-text").text(""),n.selectAll("line.link-arrow").attr("marker-end",this._getRelativeUrl("#link-arrow")).classed("success",!1).classed("warn",!1).classed("danger",!1)}}},{key:"_linkColorScale",value:function(t){if(isNaN(t))throw new TypeError("Argument should be number.");if(t<0||t>1)throw new RangeError("Argument should whithin the range 0 to 1.");return t<=.2?"#ff0000":t>.2&&t<=.4?"yellow":"#18DB02"}},{key:"_linkColorScaleArrow",value:function(t){if(isNaN(t))throw new TypeError("Argument should be number.");if(t<0||t>1)throw new RangeError("Argument should whithin the range 0 to 1.");return t<.1?this._getRelativeUrl("#link-arrow-danger"):t>=.1&&t<.6?this._getRelativeUrl("#link-arrow-warn"):this._getRelativeUrl("#link-arrow-success")}},{key:"setLinksText",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t){if(!p.default.isArray(t))throw new TypeError("the argument should be Array");var o=this.elements.screenCanvas;p.default.forEach(t,function(t){var r=o.select('g.link[data-link-id="'+t.source+"-"+t.target+'"]');if(r.select("text.link-text").text(function(e){return""+t.text+n}),i){var a=t.text/100;r.select("line.link-arrow").attr("marker-end",function(n){var i=t.text/100;if(!isNaN(i))return e._linkColorScaleArrow(i)}).classed("success",a>=.6).classed("warn",a<.6&&a>=.1).classed("danger",a<.1)}})}}},{key:"_reflowAreas",value:function(){var t=this.elements.area.data(this.areas,function(t){return t.areaId});t.exit().remove();var e=t.enter().append("g").attr("class","area").attr("transform",function(t){return"translate("+t.x+","+t.y+")"});if(e.append("rect").attr("class","area-bg").attr("x",0).attr("y",0).attr("width",0).attr("height",0),this.elements.area=e.merge(t),this.options.resizeAreaEnabled){var n=["west","north","east","south","south-west","north-west","north-east","south-east"],i=this._window,o=this.uniqId,r=this.options.areaMinSize,a=this.elements.svg,s=this;p.default.forEach(n,function(t){e.append("rect").attr("class","area-handle area-handle-"+t).attr("x",0).attr("y",0).attr("width",0).attr("height",0).on("mousedown",function(e){f.event.preventDefault(),f.event.stopPropagation();var n=f.event.x,l=f.event.y,h=p.default.pick(e,["x","y","width","height"]),c=p.default.clone(h);a.classed("resizing-area",!0),i.on("mousemove."+o,function(){var i=f.event.x,o=f.event.y,a=Math.round(i-n),y=Math.round(o-l);if(-1!==t.indexOf("east")?c.width=h.width+a:-1!==t.indexOf("west")&&(c.x=h.x+a,c.width=h.width-a),-1!==t.indexOf("south")?c.height=h.height+y:-1!==t.indexOf("north")&&(c.y=h.y+y,c.height=h.height-y),c.width<r){var u=c.width;c.width=r,-1!==t.indexOf("west")&&(c.x-=r-u)}if(c.height<r){var d=c.height;c.height=r,-1!==t.indexOf("north")&&(c.y-=r-d)}p.default.assign(e,c),s._tick({})}).on("mouseup."+o,function(){i.on("mousemove."+o,null).on("mouseup."+o,null),a.classed("resizing-area",!1),p.default.isEqual(h,c)||s._pushHistory("resizeArea",{area:e,from:h,to:c}),s.state=T,s.emit("stateChange",s.state)}),s.state="resizing-area",s.emit("stateChange",s.state)})})}e.on("click",function(){f.event.stopPropagation()}),this.options.dragAreaEnabled&&e.call(this.dragArea)}},{key:"_reflowNotes",value:function(){var t=this.elements.note.data(this.notes,function(t){return t.noteId});t.exit().remove();var e=t.enter().append("g").attr("class","note").attr("transform",function(t){return"translate("+t.x+","+t.y+")"});this.elements.note=e.merge(t),this.options.dragNoteEnabled&&e.call(this.dragNote);var n=this,i=this.elements.svg;e.each(function(t){var e=f.select(this);if(t.shape||(t.shape=new w.default(t,n)),t.shape.renderTo(e),n.options.dragNoteArrowEnabled){e.classed("drag-note-arrow-enabled",!0);var o=t.shape,r=f.drag().on("start",function(){f.event.sourceEvent.preventDefault(),f.event.sourceEvent.stopPropagation(),t._oldArrowDirection=t.arrowDirection,o._arrowDx=o._arrowX,o._arrowDy=o._arrowY,i.classed("dragging-note-arrow",!0),n.state="dragging-note-arrow",n.emit("stateChange",n.state)}).on("drag",function(){o._arrowDx+=f.event.dx,o._arrowDy+=f.event.dy;var t=Math.atan(o._arrowDy/o._arrowDx);p.default.isNaN(t)?t=w.default.DEFAULT_ARROW_DIRECTION:o._arrowDx<0&&(t+=Math.PI),o.setArrowDirection(t)}).on("end",function(){i.classed("dragging-note-arrow",!1),delete o._arrowDx,delete o._arrowDy;var e=t._oldArrowDirection,r=t.arrowDirection;e!==r&&n._pushHistory("dragNoteArrow",{note:t,from:e,to:r}),n.state=T,n.emit("stateChange",n.state)});e.select(".arrow-handle").call(r)}}),e.on("click",function(){f.event.stopPropagation()})}},{key:"_tick",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.elements,n=e.node,i=e.link,o=e.guide,r=e.area,a=e.note;if((!t||t.node)&&(t&&t.node?n.each(function(e){e===t.node&&f.select(this).attr("transform",e.shape.getAbsoluteTransform())}):n.attr("transform",function(t){return t.shape.getAbsoluteTransform()}),this.options.guideLineEnabled)){var s=l(this.options.size,2),h=s[0],c=s[1];o.each(function(t){var e=f.select(this),n=t.shape;p.default.forEach({vertical:n.getVerticals(),horizontal:n.getHorizontals()},function(t,n){p.default.forEach(t,function(t,i){t=Math.round(t-.5)+.5;var o=e.select(".pos-"+i);"vertical"===n?o.attr("x1",t).attr("y1",0).attr("x2",t).attr("y2",c):o.attr("x1",0).attr("y1",t).attr("x2",h).attr("y2",t)})})})}if(!t||t.node||t.link){var y=this.options,u=y.linkMirrorGap,d=y.linkTextOffset,x=y.clearOnePxLink;i.each(function(e){if(!(t&&t.node&&e.source!==t.node&&e.target!==t.node||t&&t.link&&t.link!==e&&(e.source!==t.link.target||e.target!==t.link.source))){var n=e.source.shape,i=e.target.shape;if(void 0===n.px||void 0===i.px||n.px!==n.x||n.py!==n.y||i.px!==i.x||i.py!==i.y){var o=e.target.x-e.source.x,r=e.target.y-e.source.y,a=[0,0],s=Math.atan(r/o)-Math.PI/2;p.default.isNaN(s)?s=Math.PI/2:o<0&&(s+=Math.PI),s<0&&(s+=2*Math.PI),e.mirror&&(a[0]=Math.cos(s)*u/2,a[1]=Math.sin(s)*u/2);var l=n.getLinkPointAsSource(i,a),h=l.x1,c=l.y1,y=i.getLinkPointAsTarget(n,a),v=y.x2,g=y.y2,m=v-h,b=g-c,w={x1:h,y1:c,x2:v,y2:g};if(b<0^r<=0&&m<0^o<=0){w=Math.sqrt(b*b+m*m)>Math.sqrt(r*r+o*o)?{x1:e.source.x+a[0],y1:e.source.y+a[1],x2:e.target.x+a[0],y2:e.target.y+a[1]}:{x1:v,y1:g,x2:h,y2:c}}var k=f.select(this),_=k.selectAll("line");p.default.forEach(w,function(t,e){x&&(t=Math.round(t-.5)+.5),_.attr(e,t)});var E=(s+Math.PI/2)%(2*Math.PI),M=(w.x1+w.x2)/2+Math.cos(s)*d,P=(w.y1+w.y2)/2+Math.sin(s)*d;E>Math.PI/2&&E<3*Math.PI/2&&(E+=Math.PI),k.select(".link-text").attr("transform","translate("+M+","+P+")rotate("+180*E/Math.PI+")"),k.select(".link-text-bg").attr("transform","translate("+M+","+P+")rotate("+180*E/Math.PI+")")}}})}if(!t||!t.node){var v=this.options,g=v.resizeHandleSize,m=v.resizeHandleExpandSize,b=[{direction:"north-west",x:-m,y:-m,width:g+m,height:g+m},{direction:"north",x:g,y:-m,width:function(t){return Math.max(0,t.width-2*g)},height:g/2+m},{direction:"north-east",x:function(t){return t.width-g},y:-m,width:g+m,height:g+m},{direction:"east",x:function(t){return t.width-g/2},y:g,width:g/2+m,height:function(t){return Math.max(0,t.height-2*g)}},{direction:"south-east",x:function(t){return t.width-g},y:function(t){return t.height-g},width:g+m,height:g+m},{direction:"south",x:g,y:function(t){return t.height-g/2},width:function(t){return Math.max(0,t.width-2*g)},height:g/2+m},{direction:"south-west",x:-m,y:function(t){return t.height-g},width:g+m,height:g+m},{direction:"west",x:-m,y:g,width:g/2+m,height:function(t){return Math.max(0,t.height-2*g)}}];r.attr("transform",function(t){return"translate("+t.x+","+t.y+")"}),r.select(".area-bg").attr("width",function(t){return t.width}).attr("height",function(t){return t.height}),r.each(function(){var t=f.select(this);p.default.forEach(b,function(e){t.select(".area-handle-"+e.direction).attr("x",e.x).attr("y",e.y).attr("width",e.width).attr("height",e.height)})}),a.attr("transform",function(t){return"translate("+t.x+","+t.y+")"})}}},{key:"_forceEnd",value:function(){this._tick(),this._force.on("end",null),this._force=null,this.fixed=!0,this.elements.svg.classed("fixed",!0),this.options.centerEnabled&&(this.centerCanvas(),this.reflow()),this.options.autoScaleToFitCanvas&&(this.scaleToFitCanvas(),this.reflow()),this.options.dragNodeEnabled&&this.elements.node.call(this.dragNode),this.state=T,this.emit("stateChange",this.state),this.emit("forceEnd")}},{key:"_getRelativeUrl",value:function(t){return"url("+this.options.baseHref+t+")"}},{key:"idle",value:function(){switch(this.unsetActive(),this.state){case"linking":this.unToLink();break;case"drawing-area":this.unToAppendArea();break;case"locating-note":case"inputting-note":this.unToAppendNote()}}},{key:"toAppendArea",value:function(){this.idle();var t=this.elements,e=t.svg,n=t.canvasWrapper,i=t.selectRect,o=t.screenCanvas,r=o.node(),a=this,s=this._window,h=this.uniqId,c=this.options.areaMinSize;e.classed("drawing-area",!0),n.on(".zoom",null),e.on("mousedown",function(){f.event.preventDefault();var t=f.mouse(r),e=l(t,2),n=e[0],o=e[1];n=Math.round(n-.5)+.5,o=Math.round(o-.5)+.5;var y={x:n,y:o,width:0,height:0};p.default.forEach(y,function(t,e){i.attr(e,t)}),i.classed("active",!0),s.on("mousemove."+h,function(){var t=f.mouse(r),e=l(t,2),s=e[0],h=e[1];s=Math.min(Math.max(0,s),a.options.size[0]-1),h=Math.min(Math.max(0,h),a.options.size[1]-1),s=Math.round(s-.5)+.5,h=Math.round(h-.5)+.5;var u=s-n,d=h-o,x=Math.abs(u),v=Math.abs(d);x<c/2?x=0:x<c&&(x=c),v<c/2?v=0:v<c&&(v=c),y={x:u<0?s:n,y:d<0?h:o,width:x,height:v},p.default.forEach(y,function(t,e){i.attr(e,t)})}).on("mouseup."+h,function(){a.unToAppendArea(),y.width>0&&y.height>0&&a.appendArea(y)})}),a.state="drawing-area",a.emit("stateChange",a.state)}},{key:"unToAppendArea",value:function(){var t=this.elements,e=t.svg,n=t.canvasWrapper,i=t.selectRect;e.on("mousedown",null),this._window.on("mousemove."+this.uniqId,null).on("mouseup."+this.uniqId,null),e.classed("drawing-area",!1),i.classed("active",!1),this.options.wheelZoomEnabled&&n.call(this.zoomCanvas),this.state=T,this.emit("stateChange",this.state)}},{key:"toAppendNote",value:function(){var t=this;this.idle();var e=this.elements.html;e.classed("active locating-note",!0),e.on("click",function(){f.event.preventDefault();var n=f.mouse(e.node()),i=l(n,2),o=i[0],r=i[1];e.classed("locating-note",!1),e.classed("editing-note",!0),e.on("click",null),t.showNoteInput(o,r)}),this.state="locating-note",this.emit("stateChange",this.state)}},{key:"unToAppendNote",value:function(){var t=this.elements,e=t.html,n=t.htmlInput;n.node().value="",e.on("click",null),e.classed("active editing-note",!1),n.classed("active",!1),this._htmlInputKeypress&&(this._htmlInputKeypress.reset(),delete this._htmlInputKeypress),n.on("blur",null),this.state=T,this.emit("stateChange",this.state)}},{key:"showNoteInput",value:function(t,e){var n=this,i=this.elements,o=i.html,r=i.htmlInput,a=r.node();o.on("click",null),r.classed("active",!0);var s=a.getBoundingClientRect();r.style("left",t-s.width/2+"px").style("top",e-s.height/2+"px"),a.focus();var l=this._htmlInputKeypress=new _.default(a);l.bind(["ctrl+enter","command+enter"],function(){return n.appendNoteAt(t,e)}),l.bind("esc",function(){return n.unToAppendNote()}),r.on("blur",function(){return n.appendNoteAt(t,e)}),this.state="inputting-note",this.emit("stateChange",this.state)}},{key:"appendNoteAt",value:function(t,e){var n=this.elements.htmlInput.node().value;this.unToAppendNote(),n&&this.appendNote({content:n,x:t,y:e})}},{key:"toLink",value:function(){this.idle();var t=this.elements,e=t.svg,n=t.canvasWrapper,i=t.linkLine,o=t.node,r=t.area,a=t.screenCanvas,s=a.node(),h=this,c=this.keyId,y=this.uniqId,u=this._window;n.on(".zoom",null),o.on(".drag",null),r.on(".drag",null),e.classed("linking",!0).on("mousedown",function(){f.event.preventDefault();var t=f.mouse(s),e=l(t,2),n=e[0],r=e[1];i.attr("x1",n).attr("y1",r).attr("x2",n).attr("y2",r).classed("active",!0);var a=h.getClosestNode(f.event.target);o.classed("hover",function(t){return t===a}),u.on("mousemove."+y,function(){var t=h.getClosestNode(f.event.target);o.classed("hover",function(e){return e===t||e===a});var e=f.mouse(s),n=l(e,2),r=n[0],c=n[1];i.attr("x2",r).attr("y2",c)}).on("mouseup."+y,function(){h.unToLink();var t=h.getClosestNode(f.event.target);if(a&&t&&a!==t){var e={source:a,target:t},n=a[c]+"=>"+t[c];p.default.find(h.links,function(t){return n===t.source[c]+"=>"+t.target[c]})||h.link(e)}})}),this.state="linking",this.emit("stateChange",this.state)}},{key:"unToLink",value:function(){var t=this.elements,e=t.svg,n=t.canvasWrapper,i=t.linkLine,o=t.node,r=t.area,a=this.options,s=a.wheelZoomEnabled,l=a.dragNodeEnabled,h=a.dragAreaEnabled;this._window.on("mousemove."+this.uniqId,null).on("mouseup."+this.uniqId,null),e.classed("linking",!1).on("mousedown",null),i.classed("active",!1),s&&n.call(this.zoomCanvas),l&&o.call(this.dragNode),o.classed("hover",!1),h&&r.call(this.dragArea),this.state=T,this.emit("stateChange",this.state)}},{key:"getClosestGuides",value:function(t){var e=this.nodes,n=this.options.guideThreshold,i=t.x,o=t.y,r={vertical:{cx:i},horizontal:{cy:o}},a={};return p.default.forEach(r,function(n,i){a[i]=p.default.chain(n).map(function(n,o){return p.default.chain(e).without(t).map(function(t){return p.default.chain(t.shape["horizontal"===i?"getHorizontals":"getVerticals"]()).map(function(e,r){return{node:t,value:e-n,diff:Math.abs(e-n),sourcePosition:o,targetPosition:r,direction:i}}).minBy("diff").value()}).minBy("diff").value()}).minBy("diff").value()}),this.elements.guide.selectAll("line").classed("active",!1),a.vertical.diff<n&&this.elements.guide.each(function(t){t===a.vertical.node&&f.select(this).select(".pos-"+a.vertical.targetPosition).classed("active",!0)}),a.horizontal.diff<n&&this.elements.guide.each(function(t){t===a.horizontal.node&&f.select(this).select(".pos-"+a.horizontal.targetPosition).classed("active",!0)}),a}},{key:"getClosestNode",value:function(t){for(;t&&t!==document;){var e=f.select(t);if(e.classed("node"))return e.datum();t=t.parentNode}return null}},{key:"setActive",value:function(t,e){var n=this,i=this.elements[t].filter(function(t){return t===e});i&&(t===this._activeType&&i.datum()===(this._activeElem&&this._activeElem.datum())||(this.unsetActive(!1),this._activeElem=i.classed("active",!0),this._activeType=t,this.elements.svg.on("click.active",function(){return n.unsetActive()}),"link"===t&&i.select(".link-arrow").attr("marker-end",this._getRelativeUrl("#link-arrow-active")),this.emit("activeChange",t,e)))}},{key:"getActive",value:function(t){return this._activeType===t&&this._activeElem&&this._activeElem.datum()}},{key:"unsetActive",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.elements.svg.on("click.active",null),this._activeElem){this._activeElem.classed("active",!1);var e=this._activeType;"link"===e&&this._activeElem.select(".link-arrow").attr("marker-end",this._getRelativeUrl("#link-arrow")),this._activeElem=null,this._activeType=null,t&&this.emit("activeChange",e,null)}}},{key:"appendNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nodes.length,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.nodes.splice(e,0,t),n&&(this._pushHistory("appendNode",{node:t,index:e}),this.reflow(!0,{node:t}))}},{key:"removeNode",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getActive("node");if(t=t||n){var i=p.default.findIndex(this.nodes,t);if(-1!==i){p.default.remove(this.nodes,t);var o=p.default.remove(this.links,function(e){return e.source===t||e.target===t});e&&(this._pushHistory("removeNode",{node:t,links:o,index:i}),this.reflow(!1,{node:t})),t===n&&this.unsetActive()}}}},{key:"rotateNode",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.getActive("node");(t=t||i)&&0!==e&&(t.shape.rotate(e),this._tick({node:t}),n&&this._pushHistory("rotateNode",{node:t,deg:e}))}},{key:"setNodeShape",value:function(t,e,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=this.getActive("node");if(t=t||o){var r=t.shape,a=t.label;r.shapeName===e&&a===n||(p.default.isEmpty(n)?delete t.label:t.label=n,r.destroy(),t.shape=new m[e](t,this),t.shape.renderTo(r.elem),this._tick({node:t}),i&&this._pushHistory("setNodeShape",{node:t,from:r.shapeName,to:e}))}}},{key:"setNodeTextPosition",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.getActive("node");if(t=t||i){var o=t.textPosition||I;o!==e&&(t.textPosition=e,t.shape.reRenderText(),this._tick({node:t}),n&&this._pushHistory("setNodeTextPosition",{node:t,from:o,to:e}))}}},{key:"setCapacityVisibility",value:function(t){this.options.capacityVisibility=t,this.elements.node.each(function(e){e.shape.setCapacityVisibility(t)}),this._tick()}},{key:"setCapacityVal",value:function(t,e,n,i){this.elements.node.each(function(o){var r=p.default.find(t,function(t){return p.default.eq(t.appId,o.appId)});o.shape.setCapacityVal(r&&r.capacity||null,e,n,i)}),this._tick()}},{key:"link",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.links.push(t),e&&(this._pushHistory("link",{link:t}),this.reflow(!1,{link:t}))}},{key:"unlink",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getActive("link");(t=t||n)&&(p.default.remove(this.links,t),e&&(this._pushHistory("unlink",{link:t}),this.reflow(!1,{link:t})),t===n&&this.unsetActive())}},{key:"forwardNode",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getActive("node");if(t=t||n){var i=p.default.findIndex(this.nodes,t);i>=this.nodes.length-1||(this.nodes.splice(i,1),this.nodes.splice(i+1,0,t),e&&(this._pushHistory("forwardNode",{node:t}),this.reflow(!0,{node:t})),t===n&&this.emit("activeNodeChange",t))}}},{key:"backwardNode",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getActive("node");if(t=t||n){var i=p.default.findIndex(this.nodes,t);i<=0||(this.nodes.splice(i,1),this.nodes.splice(i-1,0,t),e&&(this._pushHistory("backwardNode",{node:t}),this.reflow(!0,{node:t})),t===n&&this.emit("activeNodeChange",t))}}},{key:"appendArea",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.areas.length,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t.areaId||(t.areaId=p.default.uniqueId("area")),this.areas.splice(e,0,t),n&&(this._pushHistory("appendArea",{area:t,index:e}),this.reflow(!1,{area:t}))}},{key:"removeArea",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="area"===this._activeType&&this._activeElem&&this._activeElem.datum();if(t=t||n){var i=p.default.findIndex(this.areas,t);-1!==i&&(p.default.remove(this.areas,t),e&&(this._pushHistory("removeArea",{area:t,index:i}),this.reflow(!1,{area:t})),t===n&&this.unsetActive())}}},{key:"appendNote",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.notes.length,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t.noteId||(t.noteId=p.default.uniqueId("note")),this.notes.splice(e,0,t),n&&(this._pushHistory("appendNote",{note:t,index:e}),this.reflow(!1,{note:t}))}},{key:"removeNote",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="note"===this._activeType&&this._activeElem&&this._activeElem.datum();if(t=t||n){var i=p.default.findIndex(this.notes,t);-1!==i&&(p.default.remove(this.notes,t),e&&(this._pushHistory("removeNote",{note:t,index:i}),this.reflow(!1,{note:t})),t===n&&this.unsetActive())}}},{key:"setNoteContent",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i="note"===this._activeType&&this._activeElem&&this._activeElem.datum();if((t=t||i)&&t.content!==e){var o=t.content;t.content=e,t.shape.reRenderText(),n&&this._pushHistory("setNoteContent",{note:t,from:o,to:e})}}},{key:"_pushHistory",value:function(t,e){var n={action:t,data:e};this.history.push(n),this.emit("history","push",n)}},{key:"undo",value:function(){var t=this,e=this.history.undo();if(!e)return null;var n=e.action,i=e.data,o=!1,r=!0,a=!0,s=null,l=i.node,h=i.link,c=i.area,y=i.note;switch(n){case"appendNode":this.removeNode(i.node,!1),s={node:l},a=!1;break;case"removeNode":this.appendNode(i.node,i.index,!1),s={node:l},i.links&&p.default.forEach(i.links,function(e){return t.link(e,!1)}),o=!0;break;case"link":this.unlink(i.link,!1),s={link:h},a=!1;break;case"unlink":this.link(i.link,!1),s={link:h};break;case"dragNode":p.default.assign(i.node,i.from),r=!1,this._tick();break;case"forwardNode":this.backwardNode(i.node,!1),s={node:l},o=!0;break;case"backwardNode":this.forwardNode(i.node,!1),s={node:l},o=!0;break;case"rotateNode":this.rotateNode(i.node,-i.deg,!1),r=!1;break;case"setNodeShape":this.setNodeShape(i.node,i.from,!1),r=!1;break;case"setNodeTextPosition":this.setNodeTextPosition(i.node,i.from,!1),r=!1;break;case"appendArea":this.removeArea(i.area,!1),s={area:c},a=!1;break;case"removeArea":this.appendArea(i.area,i.index,!1),s={area:c};break;case"dragArea":case"resizeArea":p.default.assign(i.area,i.from),r=!1,this._tick({area:c});break;case"appendNote":this.removeNote(i.note,!1),s={note:y},a=!1;break;case"removeNote":this.appendNote(i.note,i.index,!1),s={note:y};break;case"setNoteContent":this.setNoteContent(i.note,i.from,!1),r=!1;break;case"dragNote":p.default.assign(i.note,i.from),r=!1,this._tick();break;case"dragNoteArrow":i.note.shape.setArrowDirection(i.from),r=!1;break;default:throw new Error("unknown history action: "+n)}return r&&this.reflow(o,s),a&&(i.note&&this.setActive("note",i.note),i.area&&this.setActive("area",i.area),i.link&&this.setActive("link",i.link),i.node&&this.setActive("node",i.node)),this.emit("history","undo",e),e}},{key:"redo",value:function(){var t=this.history.redo();if(!t)return null;var e=t.action,n=t.data,i=!1,o=!0,r=!0,a=null,s=n.node,l=n.link,h=n.area,c=n.note;switch(e){case"appendNode":this.appendNode(n.node,n.index,!1),a={node:s},i=!0;break;case"removeNode":this.removeNode(n.node,!1),a={node:s},r=!1;break;case"link":this.link(n.link,!1),a={link:l};break;case"unlink":this.unlink(n.link,!1),a={link:l},r=!1;break;case"dragNode":p.default.assign(n.node,n.to),o=!1,this._tick({node:s});break;case"forwardNode":this.forwardNode(n.node,!1),a={node:s},i=!0;break;case"backwardNode":this.backwardNode(n.node,!1),a={node:s},i=!0;break;case"rotateNode":this.rotateNode(n.node,n.deg,!1),o=!1;break;case"setNodeShape":this.setNodeShape(n.node,n.to,!1),o=!1;break;case"setNodeTextPosition":this.setNodeTextPosition(n.node,n.to,!1),o=!1;break;case"appendArea":this.appendArea(n.area,n.index,!1),a={area:h};break;case"removeArea":this.removeArea(n.area,!1),a={area:h},r=!1;break;case"dragArea":case"resizeArea":p.default.assign(n.area,n.to),o=!1,this._tick({area:h});break;case"appendNote":this.appendNote(n.note,n.index,!1),a={note:c};break;case"removeNote":this.removeNote(n.note,!1),a={note:c},r=!1;break;case"setNoteContent":this.setNoteContent(n.note,n.to,!1),o=!1;break;case"dragNote":p.default.assign(n.note,n.to),o=!1,this._tick();break;case"dragNoteArrow":n.note.shape.setArrowDirection(n.to),o=!1;break;default:throw new Error("unknown history action: "+e)}return o&&this.reflow(i,a),r&&(n.note&&this.setActive("note",n.note),n.area&&this.setActive("area",n.area),n.link&&this.setActive("link",n.link),n.node&&this.setActive("node",n.node)),this.emit("history","redo",t),t}},{key:"initLinks",value:function(){var t=this.keyId,e=this.nodes,n=this.links,i=p.default.map(e,t);if(p.default.uniq(i).length!==e.length)throw new ReferenceError("duplicated ids in nodes");var o=p.default.zipObject(i,e);p.default.forEach(n,function(t){if(!o[t.source])throw new ReferenceError("undefined link source node: "+t.source);if(!o[t.target])throw new ReferenceError("undefined link target node: "+t.target);t.source=o[t.source],t.target=o[t.target]})}}]),e}(y.default);A.STATE_INITIALIZING=M,A.STATE_FORCE_TICKING=P,A.STATE_IDLE=T,A.STATE_LINKING="linking",A.STATE_DBLCLICK="dblclick",A.STATE_DRAG_START="drag-start",A.STATE_DRAG_END="drag-end",A.STATE_DRAGGING_CANVAS="dragging-canvas",A.STATE_DRAG_NODE_START="dragging-node-start",A.STATE_DRAGGING_NODE="dragging-node",A.STATE_DRAG_NODE_END="dragging-node-end",A.STATE_DRAWING_AREA="drawing-area",A.STATE_DRAG_AREA_START="dragging-area-start",A.STATE_DRAGGING_AREA="dragging-area",A.STATE_DRAG_AREA_END="dragging-area-end",A.STATE_RESIZING_AREA="resizing-area",A.STATE_LOCATING_NOTE="locating-note",A.STATE_INPUTTING_NOTE="inputting-note",A.STATE_DRAG_NOTE_START="dragging-note-start",A.STATE_DRAGGING_NOTE="dragging-note",A.STATE_DRAG_NOTE_END="dragging-note-end",A.STATE_DRAGGING_NOTE_ARROW="dragging-note-arrow",A.STATE_ZOOM_CANVAS_START="zoom-canvas-start",A.STATE_ZOOMING_CANVAS="zooming-canvas",A.STATE_ZOOM_CANVAS_END="zoom-canvas-end",A.DEFAULT_NODE_TEXT_POSITION=I,e.default=A},212:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.maxStates,o=void 0===n?100:n;i(this,t),this._history=[],this._cursor=-1,this._maxStates=o}return o(t,[{key:"current",value:function(){return this._history[this._cursor]||null}},{key:"push",value:function(t){for(this._history.splice(this._cursor+=1);this._history.length&&this._history.length>=this._maxRecord;)this._cursor-=1,this._history.shift();return this._history.push(t),this}},{key:"replace",value:function(t){return this._history.splice(this._cursor,1,t),this}},{key:"back",value:function(){return this.canBack()?this._history[this._cursor-=1]||null:null}},{key:"forward",value:function(){return this.canForward()?this._history[this._cursor+=1]||null:null}},{key:"go",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this._cursor+t;return e<-1||e>this._history.length-1?null:this._history[this._cursor=e]||null}},{key:"canBack",value:function(){return this._cursor>=0}},{key:"canForward",value:function(){return this._cursor<this._history.length-1}},{key:"undo",value:function(){var t=this.current();return this.back(),t}},{key:"redo",value:function(){return this.forward()}},{key:"canUndo",value:function(){return!!this.current()}},{key:"canRedo",value:function(){return this.canForward()}},{key:"length",get:function(){return this._history.length}}]),t}();e.default=r},213:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),l=n(5),h=i(l),c=n(41),y=i(c),u=function(t){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.width,s=void 0===a?40:a;o(this,e);var l=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,{width:s,points:6}));return l.shapeName="Cube",l.pvAngle=150,l.pvOffsetY=l.length*Math.cos(l.pvAngle/2/180*Math.PI),l.pvOffsetX=1*l.length/8,l.rendered=!1,l}return a(e,t),s(e,[{key:"beforeRender",value:function(t){this.positions[0][1]=this.positions[1][1]-this.pvOffsetY,this.positions[3][1]=this.positions[2][1]+this.pvOffsetY,this.positions[6][1]=this.positions[1][1]-this.pvOffsetY,this.rendered||(this.positions[1][0]-=this.pvOffsetX,this.positions[2][0]-=this.pvOffsetX,this.positions[4][0]+=this.pvOffsetX,this.positions[5][0]+=this.pvOffsetX)}},{key:"afterRender",value:function(t){var e=h.default.assignIn([],this.positions),n={x:e[0][0],y:e[1][1]+this.pvOffsetY},i=["M"+n.x+" "+n.y,"L"+e[1][0]+", "+e[1][1],"M"+n.x+" "+n.y,"L"+e[3][0]+", "+e[3][1],"M"+n.x+" "+n.y,"L"+e[5][0]+", "+e[5][1]].join("");t.select(".node-icon").append("path").attr("class","shape shape-line").attr("d",i),this.rendered=!0}}]),e}(y.default);e.default=u},214:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=n(27),l=function(t){return t&&t.__esModule?t:{default:t}}(s),h=n(20),c=n(18),y=function(t){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=r.xRadius,s=void 0===a?15:a,l=r.yRadius,h=void 0===l?5:l,c=r.verticalHeight,y=void 0===c?22:c;i(this,e);var u=2*s,p=y+2*h,d=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,{width:u,height:p}));return d.shapeName="Cylinder",d.xRadius=s,d.yRadius=h,d.verticalHeight=y,d.setBoundingRect(),d.setIntersectionShape(),d}return r(e,t),a(e,[{key:"setBoundingRect",value:function(){var t=this.width,e=this.height;this.top=-e/2,this.right=t/2,this.bottom=e/2,this.left=-t/2}},{key:"renderTo",value:function(t){this.elem=t,this.renderCapacity();var e=this.xRadius,n=this.yRadius,i=this.verticalHeight,o=this.left,r=this.width,a=["M"+o+" -"+i/2,"a "+e+" "+n+" 0 1 1 "+r+" 0","v "+i,"a "+e+" "+n+" 0 1 1 -"+r+" 0","z"].join("");t.append("g").attr("class","node-icon").append("path").attr("class","shape shape-cylinder").attr("d",a),a=["M"+o+" -"+i/2,"a "+e+" "+n+" 0 1 0 "+r+" 0","M"+o+" -"+i/6,"a "+e+" "+n+" 0 1 0 "+r+" 0","M"+o+" "+i/6,"a "+e+" "+n+" 0 1 0 "+r+" 0"].join(""),t.select(".node-icon").append("path").attr("class","shape shape-line").attr("d",a),this.renderText(),this.renderLabel()}},{key:"getIntersectionShape",value:function(t){if(this.topo.options.capacityVisibility)return this.getMaxIntersectionShape(t);var e=this.xRadius,n=this.yRadius,i=this.verticalHeight,o=this.left,r=this.width,a=[];return t&&(e+=t,n+=t,o-=t,r+=2*t),a.push(h.IntersectionParams.newArc(new c.Point2D(o,-i/2),new c.Point2D(o+r,-i/2),e,n,0,1,1)),a.push(h.IntersectionParams.newLine(new c.Point2D(o+r,-i/2),new c.Point2D(o+r,i/2))),a.push(h.IntersectionParams.newArc(new c.Point2D(o+r,i/2),new c.Point2D(o,i/2),e,n,0,1,1)),a.push(h.IntersectionParams.newLine(new c.Point2D(o,i/2),new c.Point2D(o,-i/2))),h.IntersectionParams.newPath(a)}}]),e}(l.default);e.default=y},215:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=n(41),s=function(t){return t&&t.__esModule?t:{default:t}}(a),l=function(t){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=r.width,s=void 0===a?40:a;i(this,e);var l=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,{width:s,points:4}));return l.shapeName="Diamond",l}return r(e,t),e}(s.default);e.default=l},216:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=n(113),l=function(t){return t&&t.__esModule?t:{default:t}}(s),h=function(t){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=r.radius,s=void 0===a?11:a,l=r.innerRadius,h=void 0===l?4:l;i(this,e);var c=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,{radius:s}));return c.shapeName="Dot",c.innerRadius=h,c}return r(e,t),a(e,[{key:"renderTo",value:function(t){this.elem=t,this.renderCapacity();var e=t.append("g").attr("class","node-icon"),n=this.radius-2;e.append("circle").attr("class","shape shape-dot").attr("cx",0).attr("cy",0).attr("r",n),e.append("circle").attr("class","shape shape-dot-inner").attr("cx",0).attr("cy",0).attr("r",this.innerRadius),this.renderText()}}]),e}(l.default);e.default=h},217:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=n(41),s=function(t){return t&&t.__esModule?t:{default:t}}(a),l=function(t){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=r.width,s=void 0===a?40:a;i(this,e);var l=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,{width:s,points:6}));return l.shapeName="Hexagon",l}return r(e,t),e}(s.default);e.default=l},218:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.Dot=e.Cube=e.Sphere=e.Cylinder=e.RoundHexagon=e.RoundPolygon=e.Hexagon=e.Diamond=e.Polygon=e.Triangle=e.Circle=e.Rectangle=e.default=void 0;var o=n(27),r=i(o),a=n(219),s=i(a),l=n(113),h=i(l),c=n(222),y=i(c),u=n(41),p=i(u),d=n(217),f=i(d),x=n(215),v=i(x),g=n(114),m=i(g),b=n(220),w=i(b),k=n(214),_=i(k),E=n(221),M=i(E),P=n(213),T=i(P),I=n(216),A=i(I);e.default=r.default,e.Rectangle=s.default,e.Circle=h.default,e.Triangle=y.default,e.Polygon=p.default,e.Diamond=v.default,e.Hexagon=f.default,e.RoundPolygon=m.default,e.RoundHexagon=w.default,e.Cylinder=_.default,e.Sphere=M.default,e.Cube=T.default,e.Dot=A.default},219:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=n(27),l=function(t){return t&&t.__esModule?t:{default:t}}(s),h=n(20),c=function(t){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=r.width,s=void 0===a?40:a,l=r.height,h=void 0===l?30:l;i(this,e);var c=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,{width:s,height:h}));return c.shapeName="Rectangle",c.setBoundingRect(),c.setIntersectionShape(),c}return r(e,t),a(e,[{key:"setBoundingRect",value:function(){var t=this.width,e=this.height;this.right=t/2,this.left=-this.right,this.bottom=e/2,this.top=-this.bottom}},{key:"renderTo",value:function(t){this.elem=t,this.renderCapacity();var e=this.width,n=this.height;t.append("g").attr("class","node-icon").append("rect").attr("class","shape shape-rectangle").attr("x",this.left).attr("y",this.top).attr("width",e).attr("height",n),this.renderText()}},{key:"getIntersectionShape",value:function(t){if(this.topo.options.capacityVisibility)return this.getMaxIntersectionShape(t);var e=this.top,n=this.left,i=this.width,o=this.height;return t?h.IntersectionParams.newRoundRect(n-t,e-t,i+2*t,o+2*t,t,t):h.IntersectionParams.newRect(n,e,i,o)}}]),e}(l.default);e.default=c},220:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=n(114),s=function(t){return t&&t.__esModule?t:{default:t}}(a),l=function(t){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=r.width,s=void 0===a?40:a,l=r.radius,h=void 0===l?8:l;i(this,e);var c=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,{width:s,radius:h,points:6}));return c.shapeName="RoundHexagon",c}return r(e,t),e}(s.default);e.default=l},221:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=n(27),l=function(t){return t&&t.__esModule?t:{default:t}}(s),h=n(20),c=n(18),y=function(t){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=r.radius,s=void 0===a?20:a;i(this,e);var l=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,{width:s,height:s}));return l.shapeName="Sphere",l.radius=s,l.setBoundingRect(),l.setIntersectionShape(),l}return r(e,t),a(e,[{key:"setBoundingRect",value:function(){var t=this.radius;this.top=this.left=-t,this.right=this.bottom=t}},{key:"renderTo",value:function(t){this.elem=t,this.renderCapacity();var e=this.radius,n=function(t,e,n,i,o){var r=0,a=0;return"y"===o?(r=Math.sqrt(Math.pow(n,2)-Math.pow(i-e,2))+t,a=-Math.sqrt(Math.pow(n,2)-Math.pow(i-e,2))+t):(r=Math.sqrt(Math.pow(n,2)-Math.pow(i-t,2))+e,a=-Math.sqrt(Math.pow(n,2)-Math.pow(i-t,2))+e),{a:r,b:a}},i=0-e/2-2,o=n(0,0,e,i,"y"),r=0+e/2-2,a=n(0,0,e,r,"y"),s={x:1,y:.25},l=["M0 "+(0-e),"A"+4*e/7+" "+e+" 0 0 1 0 "+(0+e),"A"+4*e/7+" "+e+" 0 0 1 0 "+(0-e),"L0 "+(0+e),"M"+o.a+" "+i,"A"+s.x+" "+s.y+" 0 0 1 "+o.b+" "+i,"M"+(0-e)+" "+-2,"A"+s.x+" "+s.y+" 0 0 0 "+(0+e)+" "+-2,"M"+a.a+" "+r,"A"+s.x+" "+s.y+" 0 0 1 "+a.b+" "+r].join("");t.append("g").attr("class","node-icon").append("circle").attr("class","shape shape-sphere").attr("cx",0).attr("cy",0).attr("r",e),t.select(".node-icon").attr("class","node-icon").append("path").attr("class","shape shape-line").attr("d",l),this.renderText(),this.renderLabel()}},{key:"getIntersectionShape",value:function(t){if(this.topo.options.capacityVisibility)return this.getMaxIntersectionShape(t);var e=this.radius;return t&&(e+=t),h.IntersectionParams.newCircle(new c.Point2D(0,0),e)}}]),e}(l.default);e.default=y},222:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=n(27),l=function(t){return t&&t.__esModule?t:{default:t}}(s),h=n(20),c=n(18),y=function(t){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=r.width,s=void 0===a?40:a,l=r.height,h=void 0===l?Math.sqrt(3)/2*s:l;i(this,e);var c=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,{width:s,height:h}));c.shapeName="Triangle",c.edge=Math.sqrt(s*s/4+h*h),c.angleB=Math.atan(h/(s/2)),c.angleA=Math.PI-2*c.angleB;var y=c.gravityAngle=Math.PI/2-c.angleB+Math.atan((c.edge/2-Math.cos(c.angleB)*s)/(Math.sin(c.angleB)*s));return c.gravityOffsetY=h/2-Math.tan(y)*s/2,c.setBoundingRect(),c.setIntersectionShape(),c}return r(e,t),a(e,[{key:"setBoundingRect",value:function(){var t=this.width,e=this.height,n=this.gravityOffsetY;this.right=t/2,this.left=-this.right,this.bottom=e/2-n,this.top=-e/2-n}},{key:"renderTo",value:function(t){this.elem=t,this.renderCapacity(),t.append("g").attr("class","node-icon").append("path").attr("class","shape shape-triangle").attr("d","M 0 "+this.top+"L "+this.right+" "+this.bottom+"H "+this.left+"Z"),this.renderText()}},{key:"getIntersectionShape",value:function(t){if(this.topo.options.capacityVisibility)return this.getMaxIntersectionShape(t);var e=this.top,n=this.right,i=this.bottom,o=this.left,r=this.angleA,a=this.angleB,s=void 0;if(t){var l=Math.sin(r/2),y=Math.cos(r/2),u=Math.sin(a),p=Math.cos(a),d=t,f=d,x=-y*d,v=e-l*d,g=e,m=Math.PI+r/2,b=Math.PI-r,w=y*d,k=v,_=n+u*d,E=i-p*d,M=n,P=i,T=-(Math.PI/2-a),I=Math.PI/2-T,A=n,N=i+d,R=o,C=N,S=o,O=i,L=Math.PI/2,D=I,j=o+x,z=i-l*d,B=[],U=h.IntersectionParams.TYPE;B.push(new h.IntersectionParams(U.ARC,[new c.Point2D(0,g),d,f,0,m,b])),B.push(new h.IntersectionParams(U.LINE,[new c.Point2D(w,k),new c.Point2D(_,E)])),B.push(new h.IntersectionParams(U.ARC,[new c.Point2D(M,P),d,f,0,T,I])),B.push(new h.IntersectionParams(U.LINE,[new c.Point2D(A,N),new c.Point2D(R,C)])),B.push(new h.IntersectionParams(U.ARC,[new c.Point2D(S,O),d,f,0,L,D])),B.push(new h.IntersectionParams(U.LINE,[new c.Point2D(j,z),new c.Point2D(x,v)])),s=h.IntersectionParams.newPath(B)}else s=h.IntersectionParams.newPolygon([new c.Point2D(0,e),new c.Point2D(o,i),new c.Point2D(n,i)]);return s}}]),e}(l.default);e.default=y},223:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(5),a=function(t){return t&&t.__esModule?t:{default:t}}(r),s=(n(20),n(18),function(){function t(e,n){i(this,t),this.note=e,this.topo=n}return o(t,[{key:"destroy",value:function(){this.elem.selectAll("*").remove()}},{key:"renderTo",value:function(t){this.elem=t,t.append("path").attr("class","note-bg"),t.append("text").attr("class","note-text").attr("x",0).attr("y",0),this.reRenderText()}},{key:"reRenderText",value:function(){var t=this.note,e=this.elem.select(".note-text"),n=a.default.trim(t.content).replace(/\r?\n|\n/g,"\n"),i=n?n.split("\n"):[];e.selectAll("tspan").remove();var o=6-10*(i.length-1);a.default.forEach(i,function(t){e.append("tspan").attr("class","note-tspan").attr("x",0).attr("y",0).attr("dy",o).text(a.default.trim(t)),o+=20}),this.setFrame()}},{key:"setFrame",value:function(){var t=this.elem,e=t.select(".note-text").node().getBBox(),n=e.width/2+20,i=e.height/2+14,o=function(t,e,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=["M"+(t-n)+" "+e,"L"+(t-n)+" "+(e-i+o),"A"+o+" "+o+" 0 0 1 "+(t-n+o)+" "+(e-i),"L"+(t+n-o)+" "+(e-i),"A"+o+" "+o+" 0 0 1 "+(t+n)+" "+(e-i+o),"L"+(t+n)+" "+(e+i-o),"A"+o+" "+o+" 0 0 1 "+(t+n-o)+" "+(e+i),"L"+(t-n+o)+" "+(e+i),"A"+o+" "+o+" 0 0 1 "+(t-n)+" "+(e+i-o),"Z"];return r&&(a.splice(7,0,"L"+t+" "+(e+i)),a.splice(8,0,"L"+(t-r)+" "+(e+i+r)),a.splice(9,0,"L"+(t-r)+" "+(e+i+o)),a.splice(10,0,"A"+o+" "+o+" 0 0 0 "+(t-r-o)+" "+(e+i))),a}(0,0,n,i,5,12).join("");t.select(".note-bg").attr("d",o)}}]),t}());e.default=s},27:function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(5),a=function(t){return t&&t.__esModule?t:{default:t}}(r),s=n(20),l=n(18),h=function(){function t(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=o.width,s=void 0===r?40:r,l=o.height,h=void 0===l?40:l;i(this,t),this.node=e,this.topo=n,this.width=s,this.height=h,this.capacityRadius=this.topo.options.capacityRadius,e.transform||(e.transform={}),a.default.defaults(e.transform,{translate:[0,0],rotate:0,scale:[1,1],skew:0})}return o(t,[{key:"destroy",value:function(){this.elem.selectAll("*").remove()}},{key:"setBoundingRect",value:function(){}},{key:"renderTo",value:function(){}},{key:"getIntersectionShape",value:function(){}},{key:"getMaxIntersectionShape",value:function(t){var e=this.capacityRadius;return t&&(e+=t),s.IntersectionParams.newCircle(new l.Point2D(0,0),e)}},{key:"renderLabel",value:function(){var t=this.elem,e=this.node,n=this.shapeName,i=this.topo.elements.scaleLevel,o=this.topo.options,r=o.labelEnabled,a=(o.labelVisibility,t.select(".shape").node().getBBox().width,t.select(".shape").node().getBBox().height);if(r&&e.label){var s=t.append("g").attr("class","node-label").classed("hidden",function(){return i<.8}),l=s.append("path").attr("class","shape-label-bg"),h=s.append("text").attr("class","shape-label-text").text(function(t){return t.label}),c=0;switch(n){case"Cylinder":case"Cube":c=-5}var y=h.node().getBBox();y={height:15,width:7.5*e.label.length},h.attr("x",y.width/2+3).attr("y",-a+2*y.height).attr("dy",c);var u={x:y.width/2+3,y:-a+2*y.height-3-1+c,rx:y.width/2+3,ry:y.height/2+3,radius:3},p=function(t,e,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return["M"+t+", "+e,"m"+-n+" 0","v"+-(i-o),"a"+o+" "+o+" 0 0 1 "+o+" "+-o,"h"+(2*n-2*o),"a"+o+" "+o+" 0 0 1 "+o+" "+o,"v"+(2*i-2*o),"a"+o+" "+o+" 0 0 1 "+-o+" "+o,"h"+-(2*n-2*o),"a"+o+" "+o+" 0 0 1 "+-o+" "+-o,"z"]}(u.x,u.y,u.rx,u.ry,u.radius).join("");l.attr("d",p),this.capacityRadius=Math.sqrt(Math.pow(Math.abs(u.x)+Math.abs(u.rx)+12,2),Math.pow(Math.abs(u.y)+Math.abs(u.ry)+12,2))}}},{key:"renderCapacity",value:function(){var t=this.elem;if(this.topo.options.capacityEnabled){var e=this.node.capacity||0,n=this.capacityRadius,i=2.5*Math.PI-2*Math.PI*e,o=+(e>.5),r=Math.cos(i)*n,a=Math.sin(i)*n;t.append("circle").attr("class","shape-capacity-bg").attr("cx",0).attr("cy",0).attr("r",n),t.append("path").attr("class","shape-capacity-circle").attr("d","M0 -"+n+"A"+n+" "+n+" 0 "+o+" 1 "+r+" "+a)}}},{key:"_scaleColor",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,.33,.66,1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["#13A7D5","#1CD521","#DEB704","#F22E20"];return d3.scaleLinear().domain(e).range(n)(t)}},{key:"setCapacityVal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,i=arguments[2],o=arguments[3],r=this.elem;this.node;if(this.topo.options.capacityEnabled){var a=this.node.capacity=t,s=this.capacityRadius,l=2*Math.PI*a,h=+(a>.5),c=Math.sin(l)*s,y=-Math.cos(l)*s,u=["M0 -"+s,"A"+s+" "+s+" 0 "+h+" 1 "+c+" "+y];1===a&&(u=["M0 0","m-"+s+" 0","a"+s+","+s+" 0 1 0 "+2*s+" 0","a"+s+","+s+" 0 1 0 -"+2*s+" 0"]),u=u.join(""),r.select("circle.shape-capacity-bg").attr("r",this.capacityRadius),r.select("path.shape-capacity-circle").attr("d",u).style("stroke",function(t){var r=n.node.capacity;return e&&r?n._scaleColor(r,i,o):null})}}},{key:"setCapacityVisibility",value:function(t){this.node.capacity&&(this.elem.classed("visible",t),t?(this.top=this.left=-this.capacityRadius,this.right=this.bottom=this.capacityRadius):this.setBoundingRect(),this.setIntersectionShape(),this.reRenderText())}},{key:"setIntersectionShape",value:function(){this.sourceShape=this.getIntersectionShape(this.topo.options.linkStartOffset),this.targetShape=this.getIntersectionShape(this.topo.options.linkEndOffset)}},{key:"renderText",value:function(){this.text=this.elem.append("text").attr("dy",.5).attr("class","node-text").text(function(t){return t.name}),this.reRenderText()}},{key:"reRenderText",value:function(){var t=this.node,e=this.text,n=void 0;switch(t.textPosition){case"top":n=this.top-14;break;case"center":n=0;break;default:n=this.bottom+14}e.attr("y",n);var i=e.node().getBBox();if(!this.topo.options.linkThroughTextEnabled){var o=this.topo.options,r=o.linkStartOffset,a=o.linkEndOffset;r+=2,a+=2,this.textSourceShape=s.IntersectionParams.newRoundRect(i.x-r,i.y-r,i.width+2*r,i.height+2*r,r,r),this.textTargetShape=s.IntersectionParams.newRoundRect(i.x-a,i.y-a,i.width+2*a,i.height+2*a,a,a)}}},{key:"getBoundingRect",value:function(){var t=this.node,e=this.width,n=this.height,i=this.top,o=this.right,r=this.bottom,a=this.left;return{top:t.y+i,right:t.x+o,bottom:t.y+r,left:t.x+a,width:e,height:n}}},{key:"getVerticals",value:function(){return{cx:this.node.x}}},{key:"getHorizontals",value:function(){return{cy:this.node.y}}},{key:"setTranslate",value:function(t,e){this.node.transform.translate=[t,e]}},{key:"setRotate",value:function(t){this.node.transform.rotate=t}},{key:"setScale",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;this.node.transform.scale=[t,e]}},{key:"setSkew",value:function(t){this.node.transform.skew=t}},{key:"translate",value:function(t,e){var n=this.node.transform.translate;n[0]+=t,n[1]+=e}},{key:"rotate",value:function(t){this.node.transform.rotate+=t}},{key:"scale",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=this.node.transform.scale;n[0]*=t,n[1]*=e}},{key:"skew",value:function(t){this.node.transform.skew+=t}},{key:"getAbsoluteTransform",value:function(){var t=this.node,e=t.transform,n=e.translate,i=e.rotate,o=e.scale,r=e.skew,a=t.x,s=t.y;n&&(a+=n[0],s+=n[1]);var l="translate("+a+","+s+")";return i&&(l+="rotate("+i+")"),r&&(l+="skewX("+r+")"),o&&(l+="scale("+o[0]+","+o[1]+")"),l}},{key:"getIntersectionMatrix",value:function(){var t=this.node,e=t.transform,n=e.translate,i=e.rotate,o=e.scale,r=e.skew,a=t.x,s=t.y;n&&(a+=n[0],s+=n[1]);var h=Math.PI/180,c=l.Matrix2D.IDENTITY;return c=c.translate(a,s),i&&(c=c.rotate(h*i)),r&&(c=c.skewX(h*r)),o&&(c=c.scaleNonUniform(o[0],o[1])),c}},{key:"getLinkPointAsSource",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.node,o=this.sourceShape,r=this.targetShape,h=this.textSourceShape,c=this.textTargetShape,y=t.node,u=i.x+e[0],p=i.y+e[1],d=y.x+e[0],f=y.y+e[1],x=s.IntersectionParams.newLine(new l.Point2D(u,p),new l.Point2D(d,f)),v=s.Intersection.intersectShapes(x,n?o:r,l.Matrix2D.IDENTITY,i.shape.getIntersectionMatrix()).points,g=void 0;h&&(g=s.Intersection.intersectShapes(x,n?h:c,l.Matrix2D.IDENTITY,i.shape.getIntersectionMatrix()).points);var m=void 0;return v&&v.length&&(m={x1:v[0].x,y1:v[0].y},m.size=Math.sqrt(Math.pow(u-m.x1,2)+Math.pow(p-m.y1,2))),g&&g.length&&(m=a.default.chain(g).map(function(t){return{x1:t.x,y1:t.y,size:Math.sqrt(Math.pow(u-t.x,2)+Math.pow(p-t.y,2))}}).concat(m).maxBy("size").value()),m||{x1:u,y1:p}}},{key:"getLinkPointAsTarget",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=this.getLinkPointAsSource(t,e,!1);return{x2:n.x1,y2:n.y1}}}]),t}();h.DEFAULT_TEXT_POSITION="bottom",e.default=h},32:function(t,e){t.exports=d3},41:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){o=!0,r=t}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),h=n(5),c=i(h),y=n(27),u=i(y),p=n(20),d=n(18),f=function(t){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.width,s=void 0===a?43:a,l=i.points,h=void 0===l?5:l;o(this,e);var c=e.compute(s,h),y=c.height,u=c.length,p=c.angle,d=c.positions,f=c.top,x=c.right,v=c.bottom,g=c.left,m=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,{width:s,height:y}));return m.shapeName="Polygon",m.points=h,m.length=u,m.angle=p,m.positions=d,m._top=f,m._right=x,m._bottom=v,m._left=g,m.setBoundingRect(),m.sourceShape=m.getIntersectionShape(n.options.linkStartOffset),m.targetShape=m.getIntersectionShape(n.options.linkEndOffset),m}return a(e,t),l(e,[{key:"setBoundingRect",value:function(){var t=this._top,e=this._right,n=this._bottom,i=this._left;this.top=t,this.right=e,this.bottom=n,this.left=i}},{key:"renderTo",value:function(t){this.elem=t,this.beforeRender(t),this.renderCapacity(),t.append("g").attr("class","node-icon").append("polygon").attr("class","shape shape-polygon").attr("points",c.default.map(this.positions,function(t){return t.join(",")}).join(" ")),this.renderText(),this.afterRender(t),this.renderLabel()}},{key:"getIntersectionShape",value:function(t){if(this.topo.options.capacityVisibility)return this.getMaxIntersectionShape(t);var e=p.IntersectionParams.TYPE,n=this.positions,i=this.angle,o=this.top,r=this.length,a=void 0;if(t){var l=Math.cos(i/2),h=Math.sin(i/2),y=t,u=t,f=l*t*2,x=-l*t,v=o-h*t,g=Math.PI+i/2,m=Math.PI-i;a=[];for(var b=0;b<n.length;b+=1){var w=s(n[b],2),k=w[0],_=w[1];a.push(new p.IntersectionParams(e.ARC,[new d.Point2D(k,_),y,u,0,g,m])),g+=m;var E=g+i/2,M=x+Math.cos(E)*f,P=v+Math.sin(E)*f,T=g+Math.PI/2,I=M+Math.cos(T)*r,A=P+Math.sin(T)*r;a.push(new p.IntersectionParams(e.LINE,[new d.Point2D(M,P),new d.Point2D(I,A)])),x=I,v=A}}else a=c.default.map(n,function(t,i){var o=i===n.length-1?0:i+1,r=new d.Point2D(t[0],t[1]),a=new d.Point2D(n[o][0],n[o][1]);return new p.IntersectionParams(e.LINE,[r,a])});return p.IntersectionParams.newPath(a)}},{key:"beforeRender",value:function(t){}},{key:"afterRender",value:function(t){}}],[{key:"compute",value:function(t,e){var n=(e-2)*Math.PI/e,i=n/2,o=Math.sin(i),r=Math.cos(i),a=void 0,s=void 0;if(e<=6)a=t/2/o;else{if(!(e<=10))throw new Error("polygon with points more than 10 is not supported");a=t/2/(r+o)}var l=s=a/r;e%2&&(s=l/2+l/2*o);for(var h=-a/2/Math.cos(n/2),c=(Math.PI-n)/2,y=0,u=h,p=[[y,u]],d=0;d<e;d+=1)y+=Math.cos(c)*a,u+=Math.sin(c)*a,p.push([y,u]),c+=Math.PI-n;return{length:a,height:s,angle:n,positions:p,top:h,right:t/2,bottom:s+h,left:-t/2}}}]),e}(u.default);e.default=f},5:function(t,e){t.exports=_},517:function(t,e,n){"use strict";e.Polynomial=n(166),e.SqrtPolynomial=n(518)},518:function(t,e,n){"use strict";function i(){this.init(arguments)}var o=n(166);i.VERSION=1,i.prototype=new o,i.prototype.constructor=i,i.superclass=o.prototype,i.prototype.eval=function(t){var e=i.superclass.eval.call(this,t);if(Math.abs(e)<1e-7&&(e=0),e<0)throw new Error("SqrtPolynomial.eval: cannot take square root of negative number");return Math.sqrt(e)},i.prototype.toString=function(){return"sqrt("+i.superclass.toString.call(this)+")"},t.exports=i},59:function(t,e,n){"use strict";function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(t){return"function"==typeof t}function r(t){return"number"==typeof t}function a(t){return"object"===(void 0===t?"undefined":l(t))&&null!==t}function s(t){return void 0===t}var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(t){if(!r(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},i.prototype.emit=function(t){var e,n,i,r,l,h;if(this._events||(this._events={}),"error"===t&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}if(n=this._events[t],s(n))return!1;if(o(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),n.apply(this,r)}else if(a(n))for(r=Array.prototype.slice.call(arguments,1),h=n.slice(),i=h.length,l=0;l<i;l++)h[l].apply(this,r);return!0},i.prototype.addListener=function(t,e){var n;if(!o(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,o(e.listener)?e.listener:e),this._events[t]?a(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,a(this._events[t])&&!this._events[t].warned&&(n=s(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){function n(){this.removeListener(t,n),i||(i=!0,e.apply(this,arguments))}if(!o(e))throw TypeError("listener must be a function");var i=!1;return n.listener=e,this.on(t,n),this},i.prototype.removeListener=function(t,e){var n,i,r,s;if(!o(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],r=n.length,i=-1,n===e||o(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(a(n)){for(s=r;s-- >0;)if(n[s]===e||n[s].listener&&n[s].listener===e){i=s;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},i.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],o(n))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},i.prototype.listeners=function(t){return this._events&&this._events[t]?o(this._events[t])?[this._events[t]]:this._events[t].slice():[]},i.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(o(e))return 1;if(e)return e.length}return 0},i.listenerCount=function(t,e){return t.listenerCount(e)}},611:function(t,e,n){e=t.exports=n(11)(),e.push([t.i,'.apps-topology, .apps-topology-html {\n  font-family: "HiraginoSansGB", "Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, sans-serif;\n  font-size: 14px; }\n\n.apps-topology {\n  visibility: hidden;\n  display: none;\n  cursor: -webkit-grab;\n  cursor: grab;\n  /* &.dragging-area {\n    .area {\n      cursor: move;\n    }\n  } */\n  /* &.dragging-note {\n    .note {\n      cursor: move;\n    }\n  } */ }\n  .apps-topology .marker {\n    fill: #CBCBCB; }\n    .apps-topology .marker.hover {\n      fill: #f16601; }\n    .apps-topology .marker.active {\n      fill: #f16601; }\n    .apps-topology .marker.success {\n      fill: #4bd126; }\n    .apps-topology .marker.warn {\n      fill: #ff8c19; }\n    .apps-topology .marker.danger {\n      fill: #ff0016; }\n    .apps-topology .marker.one-on-one {\n      fill: #46b04a; }\n    .apps-topology .marker.one-on-multiple {\n      fill: #fe6f0e; }\n  .apps-topology .node {\n    cursor: pointer; }\n    .apps-topology .node .shape {\n      fill: #167be0;\n      stroke: #ffffff;\n      stroke-width: 1.5px; }\n      .apps-topology .node .shape.shape-dot {\n        fill: #ffffff;\n        stroke: none;\n        stroke-width: 0; }\n      .apps-topology .node .shape.shape-dot-inner {\n        fill: #167be0;\n        stroke: none;\n        stroke-width: 0; }\n    .apps-topology .node .node-text {\n      fill: #167be0;\n      text-anchor: middle; }\n      .apps-topology .node .node-text.hidden {\n        visibility: hidden; }\n    .apps-topology .node.hover .shape, .apps-topology .node:hover .shape {\n      stroke: #ffffff;\n      fill: #f16601; }\n      .apps-topology .node.hover .shape.shape-dot, .apps-topology .node:hover .shape.shape-dot {\n        fill: #5f94fb;\n        stroke: #5f94fb;\n        stroke-width: 1.5px; }\n      .apps-topology .node.hover .shape.shape-dot-inner, .apps-topology .node:hover .shape.shape-dot-inner {\n        fill: #fff; }\n    .apps-topology .node.hover .node-text, .apps-topology .node:hover .node-text {\n      fill: #f16601; }\n    .apps-topology .node.hover .shape-capacity-circle, .apps-topology .node:hover .shape-capacity-circle {\n      stroke: #f16601; }\n    .apps-topology .node.hover .node-label .shape-label-bg, .apps-topology .node:hover .node-label .shape-label-bg {\n      stroke: #f16601;\n      fill: #ffffff; }\n    .apps-topology .node.hover .node-label .shape-label-text, .apps-topology .node:hover .node-label .shape-label-text {\n      fill: #7e7e7e; }\n    .apps-topology .node.active .shape {\n      stroke: #ffffff;\n      fill: #f16601; }\n      .apps-topology .node.active .shape.shape-dot {\n        fill: #5f94fb;\n        stroke: #5f94fb;\n        stroke-width: 1.5px; }\n      .apps-topology .node.active .shape.shape-dot-inner {\n        fill: #fff; }\n    .apps-topology .node.active .node-text {\n      fill: #f16601; }\n    .apps-topology .node.active .node-label .shape-label-bg {\n      stroke: #f16601;\n      fill: #ffffff; }\n    .apps-topology .node.active .node-label .shape-label-text {\n      fill: #7e7e7e; }\n    .apps-topology .node.active .shape-capacity-circle {\n      stroke: #f16601; }\n    .apps-topology .node .shape-capacity-bg {\n      fill: #ffffff;\n      stroke-width: 1;\n      stroke: #c1c1c1; }\n    .apps-topology .node .shape-capacity-circle {\n      fill: none;\n      stroke-width: 2;\n      stroke: #167be0;\n      stroke-linecap: round; }\n    .apps-topology .node .shape-capacity-bg, .apps-topology .node .shape-capacity-circle {\n      visibility: hidden; }\n    .apps-topology .node .node-label.hidden {\n      visibility: hidden; }\n    .apps-topology .node .node-label .shape-label-bg {\n      fill: #ffffff;\n      stroke: #167be0;\n      stroke-width: 2px; }\n    .apps-topology .node .node-label .shape-label-text {\n      fill: #7e7e7e;\n      text-anchor: middle;\n      font-size: 10px; }\n    .apps-topology .node.visible .shape-capacity-bg, .apps-topology .node.visible .shape-capacity-circle {\n      visibility: visible; }\n  .apps-topology .link {\n    cursor: pointer; }\n    .apps-topology .link .link-arrow {\n      stroke: #CBCBCB;\n      stroke-width: 1px; }\n      .apps-topology .link .link-arrow.success {\n        stroke: #4bd126; }\n      .apps-topology .link .link-arrow.warn {\n        stroke: #ff8c19; }\n      .apps-topology .link .link-arrow.danger {\n        stroke: #ff0016; }\n    .apps-topology .link.one-on-one .link-arrow, .apps-topology .link.one-on-one:hover .link-arrow {\n      stroke: #46b04a; }\n    .apps-topology .link.one-on-one .link-text, .apps-topology .link.one-on-one:hover .link-text {\n      fill: #46b04a;\n      font-weight: 300; }\n    .apps-topology .link.one-on-one .link-text-bg {\n      fill: #eeffef; }\n    .apps-topology .link.one-on-multiple .link-arrow, .apps-topology .link.one-on-multiple:hover .link-arrow {\n      stroke: #fe6f0e; }\n    .apps-topology .link.one-on-multiple .link-text, .apps-topology .link.one-on-multiple:hover .link-text {\n      fill: #fe6f0e;\n      font-weight: 300; }\n    .apps-topology .link.one-on-multiple .link-text-bg {\n      fill: #fff5ed; }\n    .apps-topology .link .link-bg {\n      stroke: transparent;\n      stroke-linecap: round;\n      stroke-width: 10px; }\n    .apps-topology .link .link-text-bg {\n      stroke: none;\n      fill: #fff5ed; }\n    .apps-topology .link text {\n      fill: #909090;\n      font-size: 12px;\n      text-anchor: middle;\n      visibility: hidden; }\n    .apps-topology .link:hover .link-arrow {\n      stroke: #f16601; }\n    .apps-topology .link:hover .link-text {\n      fill: #f16601; }\n    .apps-topology .link.active .link-arrow, .apps-topology .link.active:hover .link-arrow {\n      stroke: #f16601; }\n    .apps-topology .link.active .link-text, .apps-topology .link.active:hover .link-text {\n      fill: #f16601; }\n  .apps-topology .area .area-bg {\n    fill: #f9f9f9;\n    stroke: #dcdcdc;\n    stroke-dasharray: 5, 5;\n    stroke-width: 1; }\n  .apps-topology .area .area-handle {\n    fill: transparent;\n    pointer-events: none;\n    stroke: none;\n    visibility: none; }\n  .apps-topology .area .area-handle-north-west, .apps-topology .area .area-handle-south-east {\n    cursor: nwse-resize; }\n  .apps-topology .area .area-handle-north-east, .apps-topology .area .area-handle-south-west {\n    cursor: nesw-resize; }\n  .apps-topology .area .area-handle-north, .apps-topology .area .area-handle-south {\n    cursor: ns-resize; }\n  .apps-topology .area .area-handle-west, .apps-topology .area .area-handle-east {\n    cursor: ew-resize; }\n  .apps-topology .area.active .area-bg {\n    fill: #f9f9f9;\n    stroke: #dcdcdc; }\n  .apps-topology .area.active .area-handle {\n    visibility: visible;\n    pointer-events: auto; }\n  .apps-topology .area:hover:not(.active) .area-bg {\n    fill: #f9f9f9;\n    stroke: #dcdcdc; }\n  .apps-topology .note {\n    cursor: pointer; }\n    .apps-topology .note .note-bg {\n      fill: #fffefe;\n      stroke: #A7B3BE;\n      stroke-width: 1.5px; }\n    .apps-topology .note .note-text {\n      fill: #7a7e85;\n      text-anchor: middle; }\n    .apps-topology .note .note-tspan {\n      text-anchor: middle; }\n    .apps-topology .note .arrow-handle {\n      cursor: move;\n      fill: orange;\n      stroke: #999;\n      visibility: hidden; }\n    .apps-topology .note.active .note-bg {\n      stroke: #f16601; }\n    .apps-topology .note.active .note-text {\n      fill: #f16601; }\n    .apps-topology .note.active.drag-note-arrow-enabled .arrow-handle {\n      visibility: visible; }\n    .apps-topology .note:hover:not(.active) .note-bg {\n      stroke: #f16601; }\n    .apps-topology .note:hover:not(.active) .note-text {\n      fill: #f16601; }\n  .apps-topology .guide line {\n    stroke: red;\n    stroke-width: 1;\n    visibility: hidden; }\n  .apps-topology .user-canvas line {\n    visibility: hidden;\n    stroke: #CBCBCB;\n    stroke-width: 1px;\n    pointer-events: none; }\n    .apps-topology .user-canvas line.active {\n      visibility: visible; }\n  .apps-topology .user-canvas rect {\n    visibility: hidden;\n    fill: none;\n    stroke: rgba(0, 0, 0, 0.8);\n    stroke-width: 1;\n    stroke-dasharray: 5, 5;\n    pointer-events: none; }\n    .apps-topology .user-canvas rect.active {\n      visibility: visible; }\n  .apps-topology.fixed {\n    display: inline;\n    visibility: visible; }\n  .apps-topology.dragging-node, .apps-topology.dragging-area, .apps-topology.dragging-note, .apps-topology.dragging-note-arrow {\n    cursor: move; }\n  .apps-topology.dragging-canvas {\n    cursor: -webkit-grabbing;\n    cursor: grabbing; }\n  .apps-topology.dragging-node .guide line.active {\n    visibility: visible; }\n  .apps-topology.dragging-node .node {\n    cursor: inherit; }\n  .apps-topology.dragging-node .link, .apps-topology.dragging-node .area, .apps-topology.dragging-node .note {\n    pointer-events: none; }\n  .apps-topology.linking, .apps-topology.linking .node, .apps-topology.linking .link, .apps-topology.linking .note {\n    cursor: crosshair; }\n  .apps-topology.linking .area, .apps-topology.linking .link, .apps-topology.linking .note {\n    pointer-events: none; }\n  .apps-topology.drawing-area {\n    cursor: crosshair; }\n    .apps-topology.drawing-area .area {\n      pointer-events: none; }\n  .apps-topology.dragging-area .node, .apps-topology.dragging-area .link, .apps-topology.dragging-area .note, .apps-topology.resizing-area .node, .apps-topology.resizing-area .link, .apps-topology.resizing-area .note, .apps-topology.drawing-area .node, .apps-topology.drawing-area .link, .apps-topology.drawing-area .note {\n    pointer-events: none; }\n  .apps-topology.dragging-note .note, .apps-topology.dragging-note-arrow .note {\n    cursor: inherit; }\n  .apps-topology.dragging-note .node, .apps-topology.dragging-note .link, .apps-topology.dragging-note .area, .apps-topology.dragging-note-arrow .node, .apps-topology.dragging-note-arrow .link, .apps-topology.dragging-note-arrow .area {\n    pointer-events: none; }\n  .apps-topology.show-link-text .link text {\n    visibility: visible; }\n  .apps-topology .hover-inactive.node, .apps-topology .hover-inactive.area, .apps-topology .hover-inactive.note {\n    opacity: 0.3; }\n  .apps-topology .hover-inactive.link {\n    opacity: 0.15; }\n    .apps-topology .hover-inactive.link .link-arrow {\n      stroke: #aaa;\n      marker-end: none; }\n    .apps-topology .hover-inactive.link .link-text, .apps-topology .hover-inactive.link .link-text-bg {\n      visibility: hidden; }\n\n.apps-topology-html {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: none; }\n  .apps-topology-html .input-text {\n    font-family: "HiraginoSansGB", "Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, sans-serif;\n    font-size: 14px;\n    position: absolute;\n    width: 120px;\n    visibility: hidden;\n    text-align: center; }\n  .apps-topology-html.active {\n    display: block; }\n    .apps-topology-html.active .input-text.active {\n      visibility: visible; }\n  .apps-topology-html.locating-note {\n    cursor: text; }\n\n.cmdb-graph .apps-topology .node .node-text {\n  fill: #878b8f;\n  font-size: 12px; }\n\n.cmdb-graph .guide line {\n  stroke: #e1e1e1; }\n\n.cmdb-graph-legend-container {\n  position: absolute;\n  top: 20px;\n  left: 25px;\n  z-index: 2; }\n  .cmdb-graph-legend-container .legend-item {\n    position: relative;\n    float: left;\n    margin-right: 20px;\n    padding-left: 30px; }\n    .cmdb-graph-legend-container .legend-item:before {\n      content: \'\';\n      position: absolute;\n      top: 50%;\n      left: 0;\n      height: 2px;\n      width: 20px;\n      margin-top: -1px; }\n    .cmdb-graph-legend-container .legend-item.one-on-one:before {\n      background-color: #46b04a; }\n    .cmdb-graph-legend-container .legend-item.one-on-multiple:before {\n      background-color: #fe6f0e; }\n',""])},617:function(t,e,n){var i=n(611);"string"==typeof i&&(i=[[t.i,i,""]]);n(17)(i,{});i.locals&&(t.exports=i.locals)},630:function(t,e,n){t.exports=n(196)},65:function(t,e,n){"use strict";t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}}});